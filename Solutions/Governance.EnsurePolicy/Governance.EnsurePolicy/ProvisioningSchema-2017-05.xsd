<?xml version="1.0" encoding="utf-8"?>
<xsd:schema targetNamespace="http://schemas.dev.office.com/PnP/2017/05/ProvisioningSchema"
    elementFormDefault="qualified"
    xmlns="http://schemas.dev.office.com/PnP/2017/05/ProvisioningSchema"
    xmlns:pnp="http://schemas.dev.office.com/PnP/2017/05/ProvisioningSchema"
    xmlns:xsd="http://www.w3.org/2001/XMLSchema">

  <!--
  ****  WARNING ****

  If you want to change this schema, please target the proper repository, which is the PnP-Provisioning-Schema one that is
  available at the following URL:
  
  https://github.com/OfficeDev/PnP-Provisioning-Schema/
  
  Submit your Pull Requests against the experimental branch of the PnP-Provisioning-Schema repository and we will validate them.
  We plan to update the master schema (the one used here) once every 2/3 months or more, depending on the number of changes and 
  on the PnP Provisioning Engine roadmap.
  
  Thanks for your cooperation.
  
  -->

  <!-- The main element -->
  <xsd:element name="Provisioning" type="pnp:Provisioning">
    <xsd:annotation>
      <xsd:documentation xml:lang="en">
        This is the base element of a Provisioning File.
      </xsd:documentation>
    </xsd:annotation>
  </xsd:element>

  <!-- The main element for external references -->
  <xsd:element name="ProvisioningTemplate" type="pnp:ProvisioningTemplate">
    <xsd:annotation>
      <xsd:documentation xml:lang="en">
        This is the base element of a referenced SharePoint Provisioning Template File.
      </xsd:documentation>
    </xsd:annotation>
  </xsd:element>

  <xsd:complexType name="Provisioning">
    <xsd:sequence>
      <xsd:element name="Preferences" type="pnp:Preferences" minOccurs="1" maxOccurs="1">
        <xsd:annotation>
          <xsd:documentation>
            The mandatory section of preferences for the current provisioning definition.
          </xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="Localizations" type="pnp:Localizations" minOccurs="0" maxOccurs="1">
        <xsd:annotation>
          <xsd:documentation>
            An optional list of localizations files to include.
          </xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:sequence minOccurs="1" maxOccurs="unbounded">
        <xsd:element name="Templates" type="pnp:Templates" minOccurs="0">
          <xsd:annotation>
            <xsd:documentation>
              An optional section made of provisioning templates.
            </xsd:documentation>
          </xsd:annotation>
        </xsd:element>
        <xsd:element name="Sequence" type="pnp:Sequence" minOccurs="0">
          <xsd:annotation>
            <xsd:documentation>
              An optional section made of provisioning sequences, which can include Sites, Site Collections, Taxonomies, Provisioning Templates, etc.
            </xsd:documentation>
          </xsd:annotation>
        </xsd:element>
        <xsd:element name="ImportSequence" type="pnp:ImportSequence" minOccurs="0">
          <xsd:annotation>
            <xsd:documentation xml:lang="en">
              Imports sequences from an external file. All current properties should be sent to that file.
            </xsd:documentation>
          </xsd:annotation>
        </xsd:element>
      </xsd:sequence>
    </xsd:sequence>
  </xsd:complexType>

  <xsd:complexType name="Preferences" >
    <xsd:annotation>
      <xsd:documentation>
        General settings for a Provisioning file.
      </xsd:documentation>
    </xsd:annotation>
    <xsd:sequence>
      <xsd:element name="Parameters" minOccurs="0">
        <xsd:annotation>
          <xsd:documentation>
            Definition of parameters that can be used as replacement within templates and provisioning objects.
          </xsd:documentation>
        </xsd:annotation>
        <xsd:complexType>
          <xsd:sequence>
            <xsd:element name="Parameter" maxOccurs="unbounded">
              <xsd:annotation>
                <xsd:documentation>
                  A Parameter that can be used as a replacement within templates and provisioning objects.
                </xsd:documentation>
              </xsd:annotation>
              <xsd:complexType mixed="true">
                <xsd:attribute name="Key" use="required" type="xsd:string">
                  <xsd:annotation>
                    <xsd:documentation xml:lang="en">
                      The name of the Parameter
                    </xsd:documentation>
                  </xsd:annotation>
                </xsd:attribute>
                <xsd:attribute name="Required" use="optional" type="xsd:boolean" default="false">
                  <xsd:annotation>
                    <xsd:documentation>
                      When set to true then a value must be provided in the XML or provided at runtime.
                    </xsd:documentation>
                  </xsd:annotation>
                </xsd:attribute>
              </xsd:complexType>
            </xsd:element>
          </xsd:sequence>
        </xsd:complexType>
      </xsd:element>
    </xsd:sequence>
    <xsd:attribute name="Version" type="xsd:string"  use="optional">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          Provisioning File Version number, optional attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>
    <xsd:attribute name="Author" type="xsd:string" use="optional">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          Provisioning File Author name, optional attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>
    <xsd:attribute name="Generator" type="xsd:string" use="optional">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          Name of the tool generating this Provisioning File, optional attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>
  </xsd:complexType>

  <xsd:complexType name="Localizations" >
    <xsd:annotation>
      <xsd:documentation>
        An optional list of localizations files to include.
      </xsd:documentation>
    </xsd:annotation>
    <xsd:sequence>
      <xsd:element name="Localization" minOccurs="1" maxOccurs="unbounded">
        <xsd:annotation>
          <xsd:documentation>
            A Localization element
          </xsd:documentation>
        </xsd:annotation>
        <xsd:complexType>
          <xsd:attribute name="LCID" type="xsd:int" use="required">
            <xsd:annotation>
              <xsd:documentation xml:lang="en">
                The Locale ID of a Localization Language, required attribute.
              </xsd:documentation>
            </xsd:annotation>
          </xsd:attribute>
          <xsd:attribute name="Name" type="xsd:string" use="required">
            <xsd:annotation>
              <xsd:documentation xml:lang="en">
                The Name of a Localization Language, required attribute.
              </xsd:documentation>
            </xsd:annotation>
          </xsd:attribute>
          <xsd:attribute name="ResourceFile" type="xsd:string" use="required">
            <xsd:annotation>
              <xsd:documentation xml:lang="en">
                The path to the .RESX (XML) resource file for the current Localization, required attribute.
              </xsd:documentation>
            </xsd:annotation>
          </xsd:attribute>
        </xsd:complexType>
      </xsd:element>
    </xsd:sequence>
  </xsd:complexType>

  <xsd:complexType name="Templates">
    <xsd:annotation>
      <xsd:documentation xml:lang="en">
        SharePoint Templates, which can be inline or references to external files.
      </xsd:documentation>
    </xsd:annotation>
    <xsd:sequence minOccurs="0" maxOccurs="unbounded">
      <xsd:element name="ProvisioningTemplateFile" type="pnp:ProvisioningTemplateFile" minOccurs="0">
        <xsd:annotation>
          <xsd:documentation xml:lang="en">
            Reference to an external template file, which will be based on the current schema but will focus only on the SharePointProvisioningTemplate section.
          </xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="ProvisioningTemplateReference" type="pnp:ProvisioningTemplateReference" minOccurs="0">
        <xsd:annotation>
          <xsd:documentation xml:lang="en">
            Reference to another template by ID.
          </xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="ProvisioningTemplate" type="pnp:ProvisioningTemplate" minOccurs="0" />
    </xsd:sequence>
    <xsd:attribute name="ID" type="xsd:ID" use="optional">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          A unique identifier of the Templates collection, optional attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>
  </xsd:complexType>

  <xsd:complexType name="ProvisioningTemplate">

    <xsd:annotation>
      <xsd:documentation xml:lang="en">
        Represents the root element of the SharePoint Provisioning Template.
      </xsd:documentation>
    </xsd:annotation>

    <xsd:all>

      <xsd:element name="Properties" type="pnp:ProvisioningTemplateProperties" minOccurs="0" maxOccurs="1">
        <xsd:annotation>
          <xsd:documentation xml:lang="en">
            A set of custom Properties for the Provisioning Template, optional element.
          </xsd:documentation>
        </xsd:annotation>
      </xsd:element>

      <xsd:element name="SitePolicy" type="pnp:ReplaceableString" minOccurs="0" maxOccurs="1">
        <xsd:annotation>
          <xsd:documentation xml:lang="en">
            The Site Policy of the Provisioning Template, optional element.
          </xsd:documentation>
        </xsd:annotation>
      </xsd:element>

      <xsd:element name="WebSettings" type="pnp:WebSettings" minOccurs="0" maxOccurs="1">
        <xsd:annotation>
          <xsd:documentation xml:lang="en">
            Section of Settings for the current Web Site, optional element.
          </xsd:documentation>
        </xsd:annotation>
      </xsd:element>

      <xsd:element name="RegionalSettings" type="pnp:RegionalSettings" minOccurs="0" maxOccurs="1">
        <xsd:annotation>
          <xsd:documentation xml:lang="en">
            The Regional Settings of the Provisioning Template, optional element.
          </xsd:documentation>
        </xsd:annotation>
      </xsd:element>

      <xsd:element name="SupportedUILanguages" type="pnp:SupportedUILanguages" minOccurs="0" maxOccurs="1">
        <xsd:annotation>
          <xsd:documentation xml:lang="en">
            The Supported UI Languages for the Provisioning Template, optional element.
          </xsd:documentation>
        </xsd:annotation>
      </xsd:element>

      <xsd:element name="AuditSettings" type="pnp:AuditSettings" minOccurs="0" maxOccurs="1">
        <xsd:annotation>
          <xsd:documentation xml:lang="en">
            The Audit Settings for the Provisioning Template, optional element.
          </xsd:documentation>
        </xsd:annotation>
      </xsd:element>

      <xsd:element name="PropertyBagEntries" type="pnp:PropertyBagEntries" minOccurs="0" maxOccurs="1">
        <xsd:annotation>
          <xsd:documentation xml:lang="en">
            The Property Bag entries of the Provisioning Template, optional collection of elements.
          </xsd:documentation>
        </xsd:annotation>
      </xsd:element>

      <xsd:element name="Security" type="pnp:Security" minOccurs="0" maxOccurs="1">
        <xsd:annotation>
          <xsd:documentation xml:lang="en">
            The Security configurations of the Provisioning Template, optional collection of elements.
          </xsd:documentation>
        </xsd:annotation>
      </xsd:element>

      <xsd:element name="Navigation" type="pnp:Navigation" minOccurs="0" maxOccurs="1">
        <xsd:annotation>
          <xsd:documentation xml:lang="en">
            The Navigation configurations of the Provisioning Template, optional collection of elements.
          </xsd:documentation>
        </xsd:annotation>
      </xsd:element>

      <xsd:element name="SiteFields" minOccurs="0" maxOccurs="1">
        <xsd:annotation>
          <xsd:documentation xml:lang="en">
            The Site Columns of the Provisioning Template, optional element.
          </xsd:documentation>
        </xsd:annotation>
        <xsd:complexType>
          <xsd:sequence>
            <xsd:any minOccurs="1" maxOccurs="unbounded"
                      processContents="lax" namespace="##any" />
          </xsd:sequence>
        </xsd:complexType>
      </xsd:element>

      <xsd:element name="ContentTypes" minOccurs="0" maxOccurs="1">
        <xsd:annotation>
          <xsd:documentation xml:lang="en">
            The Content Types of the Provisioning Template, optional element.
          </xsd:documentation>
        </xsd:annotation>
        <xsd:complexType>
          <xsd:sequence>
            <xsd:element name="ContentType" type="pnp:ContentType"
                          minOccurs="0" maxOccurs="unbounded" />
          </xsd:sequence>
        </xsd:complexType>
      </xsd:element>

      <xsd:element name="Lists" minOccurs="0" maxOccurs="1">
        <xsd:annotation>
          <xsd:documentation xml:lang="en">
            The Lists instances of the Provisioning Template, optional element.
          </xsd:documentation>
        </xsd:annotation>
        <xsd:complexType>
          <xsd:sequence>
            <xsd:element name="ListInstance" type="pnp:ListInstance"
                          minOccurs="1" maxOccurs="unbounded" />
          </xsd:sequence>
        </xsd:complexType>
      </xsd:element>

      <xsd:element name="Features" type="pnp:Features" minOccurs="0" maxOccurs="1">
        <xsd:annotation>
          <xsd:documentation xml:lang="en">
            The Features (Site or Web) to activate or deactivate while applying the Provisioning Template, optional collection of elements.
          </xsd:documentation>
        </xsd:annotation>
      </xsd:element>

      <xsd:element name="CustomActions" type="pnp:CustomActions" minOccurs="0" maxOccurs="1">
        <xsd:annotation>
          <xsd:documentation xml:lang="en">
            The Custom Actions (Site or Web) to provision with the Provisioning Template, optional element.
          </xsd:documentation>
        </xsd:annotation>
      </xsd:element>

      <xsd:element name="Files" minOccurs="0" maxOccurs="1">
        <xsd:annotation>
          <xsd:documentation xml:lang="en">
            The Files to provision into the target Site through the Provisioning Template, optional element.
          </xsd:documentation>
        </xsd:annotation>
        <xsd:complexType>
          <xsd:sequence>
            <xsd:element name="File" type="pnp:File"
                          minOccurs="0" maxOccurs="unbounded" />
            <xsd:element name="Directory" type="pnp:Directory"
                          minOccurs="0" maxOccurs="unbounded" />
          </xsd:sequence>
        </xsd:complexType>
      </xsd:element>

      <xsd:element name="Pages" type="pnp:Pages" minOccurs="0" maxOccurs="1">
        <xsd:annotation>
          <xsd:documentation xml:lang="en">
            The Pages to provision into the target Site through the Provisioning Template, optional element.
          </xsd:documentation>
        </xsd:annotation>
      </xsd:element>

      <xsd:element name="TermGroups" minOccurs="0" maxOccurs="1">
        <xsd:annotation>
          <xsd:documentation xml:lang="en">
            The TermGroups element allows provisioning one or more TermGroups into the target Site, optional element.
          </xsd:documentation>
        </xsd:annotation>
        <xsd:complexType>
          <xsd:sequence>
            <xsd:element name="TermGroup" type="pnp:TermGroup" minOccurs="1" maxOccurs="unbounded">
              <xsd:annotation>
                <xsd:documentation xml:lang="en">
                  The TermGroup element to provision into the target Site through the Provisioning Template, optional element.
                </xsd:documentation>
              </xsd:annotation>
            </xsd:element>
          </xsd:sequence>
        </xsd:complexType>
      </xsd:element>

      <xsd:element name="ComposedLook" type="pnp:ComposedLook" minOccurs="0" maxOccurs="1">
        <xsd:annotation>
          <xsd:documentation xml:lang="en">
            The ComposedLook for the Provisioning Template, optional element.
          </xsd:documentation>
        </xsd:annotation>
      </xsd:element>

      <xsd:element name="Workflows" type="pnp:Workflows" minOccurs="0" maxOccurs="1">
        <xsd:annotation>
          <xsd:documentation xml:lang="en">
            The Workflows for the Provisioning Template, optional element.
          </xsd:documentation>
        </xsd:annotation>
      </xsd:element>

      <xsd:element name="SearchSettings" minOccurs="0" maxOccurs="1">
        <xsd:annotation>
          <xsd:documentation xml:lang="en">
            The Search Settings for the Provisioning Template, optional element.
          </xsd:documentation>
        </xsd:annotation>

        <xsd:complexType>
          <xsd:sequence>
            <xsd:element name="SiteSearchSettings" minOccurs="0">
              <xsd:annotation>
                <xsd:documentation xml:lang="en">
                  The Search Settings for the Site Collection, optional element.
                </xsd:documentation>
              </xsd:annotation>
              <xsd:complexType>
                <xsd:sequence>
                  <xsd:any minOccurs="0" maxOccurs="1" processContents="skip"  />
                </xsd:sequence>
              </xsd:complexType>
            </xsd:element>
            <xsd:element name="WebSearchSettings" minOccurs="0">
              <xsd:annotation>
                <xsd:documentation xml:lang="en">
                  The Search Settings for the Site, optional element.
                </xsd:documentation>
              </xsd:annotation>
              <xsd:complexType>
                <xsd:sequence>
                  <xsd:any minOccurs="0" maxOccurs="1" processContents="skip"  />
                </xsd:sequence>
              </xsd:complexType>
            </xsd:element>
          </xsd:sequence>
        </xsd:complexType>

      </xsd:element>

      <xsd:element name="Publishing" type="pnp:Publishing" minOccurs="0" maxOccurs="1">
        <xsd:annotation>
          <xsd:documentation xml:lang="en">
            The Publishing capabilities configuration for the Provisioning Template, optional element.
          </xsd:documentation>
        </xsd:annotation>
      </xsd:element>

      <xsd:element name="AddIns" type="pnp:AddIns" minOccurs="0" maxOccurs="1">
        <xsd:annotation>
          <xsd:documentation xml:lang="en">
            The SharePoint Add-ins to provision into the target Site through the Provisioning Template, optional element.
          </xsd:documentation>
        </xsd:annotation>
      </xsd:element>

      <xsd:element name="Providers" minOccurs="0" maxOccurs="1">
        <xsd:annotation>
          <xsd:documentation xml:lang="en">
            The Extensiblity Providers to invoke while applying the Provisioning Template, optional collection of elements.
          </xsd:documentation>
        </xsd:annotation>

        <xsd:complexType>
          <xsd:sequence>
            <xsd:element name="Provider" type="pnp:Provider"
                          minOccurs="1" maxOccurs="unbounded" />
          </xsd:sequence>
        </xsd:complexType>

      </xsd:element>

      <xsd:element name="SiteWebhooks" minOccurs="0" maxOccurs="1" type="pnp:SiteWebhooksList">
        <xsd:annotation>
          <xsd:appinfo>Added with schema version 201705</xsd:appinfo>
          <xsd:documentation xml:lang="en">
            Defines any list of Webhooks for the current site.
          </xsd:documentation>
        </xsd:annotation>
      </xsd:element>

      <xsd:element name="ClientSidePages" type="pnp:ClientSidePages" minOccurs="0" maxOccurs="1">
        <xsd:annotation>
          <xsd:appinfo>Added with schema version 201705</xsd:appinfo>
          <xsd:documentation xml:lang="en">
            The Client-side Pages to provision into the target Site through the Provisioning Template, optional element.
          </xsd:documentation>
        </xsd:annotation>
      </xsd:element>

    </xsd:all>

    <xsd:attribute name="ID" type="xsd:ID" use="required">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          The ID of the Provisioning Template, required attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>

    <xsd:attribute name="Version" type="xsd:decimal" use="optional">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          The Version of the Provisioning Template, optional attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>

    <xsd:attribute name="BaseSiteTemplate" type="xsd:string" use="optional">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          The Base SiteTemplate of the Provisioning Template, optional attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>

    <xsd:attribute name="ImagePreviewUrl" type="xsd:string" use="optional">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          The Image Preview Url of the Provisioning Template, optional attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>

    <xsd:attribute name="DisplayName" type="xsd:string" use="optional">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          The Display Name of the Provisioning Template, optional attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>

    <xsd:attribute name="Description" type="xsd:string" use="optional">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          The Description of the Provisioning Template, optional attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>

    <xsd:attribute name="TemplateCultureInfo" type="pnp:ReplaceableString" use="optional">
      <xsd:annotation>
        <xsd:appinfo>Added with schema version 201705</xsd:appinfo>
        <xsd:documentation xml:lang="en">
          The default CultureInfo of the Provisioning Template, used to format all input values, optional attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>

    <xsd:attribute name="Scope" use="optional">
      <xsd:annotation>
        <xsd:appinfo>Added with schema version 201705</xsd:appinfo>
        <xsd:documentation xml:lang="en">
          Declares the target scope of the current Provisioning Template
        </xsd:documentation>
      </xsd:annotation>
      <xsd:simpleType>
        <xsd:restriction base="xsd:string">
          <xsd:enumeration value="Undefined">
            <xsd:annotation>
              <xsd:documentation xml:lang="en">
                Scope was not defined
              </xsd:documentation>
            </xsd:annotation>
          </xsd:enumeration>
          <xsd:enumeration value="RootSite">
            <xsd:annotation>
              <xsd:documentation xml:lang="en">
                The scope is a Root web of a Site Collection
              </xsd:documentation>
            </xsd:annotation>
          </xsd:enumeration>
          <xsd:enumeration value="Web">
            <xsd:annotation>
              <xsd:documentation xml:lang="en">
                The scope is a child Web of a Site Collection
              </xsd:documentation>
            </xsd:annotation>
          </xsd:enumeration>
        </xsd:restriction>
      </xsd:simpleType>
    
    </xsd:attribute>

  </xsd:complexType>

  <xsd:complexType name="ProvisioningTemplateProperties">
    <xsd:annotation>
      <xsd:documentation xml:lang="en">
        A set of custom Properties for the Provisioning Template.
      </xsd:documentation>
    </xsd:annotation>
    <xsd:sequence>
      <xsd:element name="Property" type="pnp:StringDictionaryItem" minOccurs="1" maxOccurs="unbounded">
        <xsd:annotation>
          <xsd:documentation xml:lang="en">
            A custom Property for the Provisioning Template, collection of elements.
          </xsd:documentation>
        </xsd:annotation>
      </xsd:element>
    </xsd:sequence>
  </xsd:complexType>

  <xsd:complexType name="WebSettings">
    <xsd:annotation>
      <xsd:documentation xml:lang="en">
        Section of Settings for the current Web Site, optional element.
      </xsd:documentation>
    </xsd:annotation>

    <xsd:attribute name="RequestAccessEmail" type="xsd:string" use="optional">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          The email address to which any access request will be sent, optional attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>

    <xsd:attribute name="NoCrawl" type="xsd:boolean" use="optional">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          Defines whether the site has to be crawled or not, optional attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>

    <xsd:attribute name="WelcomePage" type="xsd:string" use="optional">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          Defines the Welcome Page (Home Page) of the site to which the Provisioning Template is applied, optional attribute.
          The page does not necessarily need to be in the current template, can be an already existing one.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>

    <xsd:attribute name="Title" type="xsd:string" use="optional">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          The Title of the Site, optional attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>

    <xsd:attribute name="Description" type="xsd:string" use="optional">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          The Description of the Site, optional attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>

    <xsd:attribute name="SiteLogo" type="xsd:string" use="optional">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          The SiteLogo of the Site, optional attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>

    <xsd:attribute name="AlternateCSS" type="xsd:string" use="optional">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          The AlternateCSS of the Site, optional attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>

    <xsd:attribute name="MasterPageUrl" type="xsd:string" use="optional">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          The MasterPage URL of the Site, optional attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>

    <xsd:attribute name="CustomMasterPageUrl" type="xsd:string" use="optional">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          The Custom MasterPage URL of the Site, optional attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>

  </xsd:complexType>

  <xsd:complexType name="RegionalSettings">
    <xsd:annotation>
      <xsd:documentation xml:lang="en">
        Defines the Regional Settings for a site.
      </xsd:documentation>
    </xsd:annotation>

    <xsd:attribute name="AdjustHijriDays" type="xsd:int" use="optional">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          The number of days to extend or reduce the current month in Hijri calendars, optional attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>

    <xsd:attribute name="AlternateCalendarType" type="pnp:CalendarType" use="optional">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          The Alternate Calendar type that is used on the server, optional attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>

    <xsd:attribute name="CalendarType" type="pnp:CalendarType" use="optional">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          The Calendar Type that is used on the server, optional attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>

    <xsd:attribute name="Collation" type="xsd:int" use="optional">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          The Collation that is used on the site, optional attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>

    <xsd:attribute name="FirstDayOfWeek" type="pnp:DayOfWeek" use="optional">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          The First Day of the Week used in calendars on the server, optional attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>

    <xsd:attribute name="FirstWeekOfYear" type="xsd:int" use="optional">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          The First Week of the Year used in calendars on the server, optional attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>

    <xsd:attribute name="LocaleId" type="xsd:int" use="optional">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          The Locale Identifier in use on the server, optional attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>

    <xsd:attribute name="ShowWeeks" type="xsd:boolean" use="optional">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          Defines whether to display the week number in day or week views of a calendar, optional attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>

    <xsd:attribute name="Time24" type="xsd:boolean" use="optional">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          Defines whether to use a 24-hour time format in representing the hours of the day, optional attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>

    <xsd:attribute name="TimeZone" type="pnp:ReplaceableInt" use="optional">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          The Time Zone that is used on the server, optional attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>

    <xsd:attribute name="WorkDayEndHour" type="pnp:WorkHour" use="optional">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          The the default hour at which the work day ends on the calendar that is in use on the server, optional attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>

    <xsd:attribute name="WorkDays" type="xsd:int" use="optional">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          The work days of Web site calendars, optional attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>

    <xsd:attribute name="WorkDayStartHour" type="pnp:WorkHour" use="optional">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          The the default hour at which the work day starts on the calendar that is in use on the server, optional attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>

  </xsd:complexType>

  <xsd:simpleType name="CalendarType">
    <xsd:annotation>
      <xsd:documentation xml:lang="en">
        The Type of Calendar used on a site.
      </xsd:documentation>
    </xsd:annotation>
    <xsd:restriction base="xsd:string">
      <xsd:enumeration value="None" />
      <xsd:enumeration value="Gregorian" />
      <xsd:enumeration value="Japan" />
      <xsd:enumeration value="Taiwan" />
      <xsd:enumeration value="Korea" />
      <xsd:enumeration value="Hijri" />
      <xsd:enumeration value="Thai" />
      <xsd:enumeration value="Hebrew" />
      <xsd:enumeration value="Gregorian Middle East French Calendar" />
      <xsd:enumeration value="Gregorian Arabic Calendar" />
      <xsd:enumeration value="Gregorian Transliterated English Calendar" />
      <xsd:enumeration value="Gregorian Transliterated French Calendar" />
      <xsd:enumeration value="Korea and Japanese Lunar" />
      <xsd:enumeration value="Chinese Lunar" />
      <xsd:enumeration value="Saka Era" />
      <xsd:enumeration value="Umm al-Qura" />
    </xsd:restriction>
  </xsd:simpleType>

  <xsd:simpleType name="DayOfWeek">
    <xsd:annotation>
      <xsd:documentation xml:lang="en">
        The Days of a Week.
      </xsd:documentation>
    </xsd:annotation>
    <xsd:restriction base="xsd:string">
      <xsd:enumeration value="Sunday" />
      <xsd:enumeration value="Monday" />
      <xsd:enumeration value="Tuesday" />
      <xsd:enumeration value="Wednesday" />
      <xsd:enumeration value="Thursday" />
      <xsd:enumeration value="Friday" />
      <xsd:enumeration value="Saturday" />
    </xsd:restriction>
  </xsd:simpleType>

  <xsd:simpleType name="WorkHour">
    <xsd:annotation>
      <xsd:documentation xml:lang="en">
        The Work Hours of a Day.
      </xsd:documentation>
    </xsd:annotation>
    <xsd:restriction base="xsd:string">
      <xsd:enumeration value="12:00AM" />
      <xsd:enumeration value="1:00AM" />
      <xsd:enumeration value="2:00AM" />
      <xsd:enumeration value="3:00AM" />
      <xsd:enumeration value="4:00AM" />
      <xsd:enumeration value="5:00AM" />
      <xsd:enumeration value="6:00AM" />
      <xsd:enumeration value="7:00AM" />
      <xsd:enumeration value="8:00AM" />
      <xsd:enumeration value="9:00AM" />
      <xsd:enumeration value="10:00AM" />
      <xsd:enumeration value="11:00AM" />
      <xsd:enumeration value="12:00PM" />
      <xsd:enumeration value="1:00PM" />
      <xsd:enumeration value="2:00PM" />
      <xsd:enumeration value="3:00PM" />
      <xsd:enumeration value="4:00PM" />
      <xsd:enumeration value="5:00PM" />
      <xsd:enumeration value="6:00PM" />
      <xsd:enumeration value="7:00PM" />
      <xsd:enumeration value="8:00PM" />
      <xsd:enumeration value="9:00PM" />
      <xsd:enumeration value="10:00PM" />
      <xsd:enumeration value="11:00PM" />
    </xsd:restriction>
  </xsd:simpleType>

  <xsd:complexType name="SupportedUILanguages">
    <xsd:annotation>
      <xsd:documentation xml:lang="en">
        Defines the Supported UI Languages for a site.
      </xsd:documentation>
    </xsd:annotation>

    <xsd:sequence>
      <xsd:element name="SupportedUILanguage" minOccurs="0" maxOccurs="unbounded">
        <xsd:annotation>
          <xsd:documentation xml:lang="en">
            Defines a single Supported UI Language for a site.
          </xsd:documentation>
        </xsd:annotation>
        <xsd:complexType>
          <xsd:attribute name="LCID" type="xsd:int" use="required">
            <xsd:annotation>
              <xsd:documentation xml:lang="en">
                The Locale ID of a Supported UI Language, required attribute.
              </xsd:documentation>
            </xsd:annotation>
          </xsd:attribute>
        </xsd:complexType>
      </xsd:element>
    </xsd:sequence>
  </xsd:complexType>

  <xsd:complexType name="AuditSettings">
    <xsd:annotation>
      <xsd:documentation xml:lang="en">
        The Audit Settings for the Provisioning Template, optional collection of elements.
      </xsd:documentation>
    </xsd:annotation>

    <xsd:sequence>
      <xsd:element name="Audit" minOccurs="0" maxOccurs="unbounded">
        <xsd:annotation>
          <xsd:documentation xml:lang="en">
            A single Audit setting defined by an AuditFlag.
          </xsd:documentation>
        </xsd:annotation>
        <xsd:complexType>
          <xsd:attribute name="AuditFlag" use="required">
            <xsd:annotation>
              <xsd:documentation xml:lang="en">
                An Audit Flag for a single Audit setting, required attribute.
              </xsd:documentation>
            </xsd:annotation>
            <xsd:simpleType>
              <xsd:annotation>
                <xsd:documentation xml:lang="en">
                  Type of an Audit Flag for a single Audit setting.
                </xsd:documentation>
              </xsd:annotation>
              <xsd:restriction base="xsd:string">
                <xsd:enumeration value="All" />
                <xsd:enumeration value="CheckIn" />
                <xsd:enumeration value="CheckOut" />
                <xsd:enumeration value="ChildDelete" />
                <xsd:enumeration value="Copy" />
                <xsd:enumeration value="Move" />
                <xsd:enumeration value="None" />
                <xsd:enumeration value="ObjectDelete" />
                <xsd:enumeration value="ProfileChange" />
                <xsd:enumeration value="SchemaChange" />
                <xsd:enumeration value="Search" />
                <xsd:enumeration value="SecurityChange" />
                <xsd:enumeration value="Undelete" />
                <xsd:enumeration value="Update" />
                <xsd:enumeration value="View" />
                <xsd:enumeration value="Workflow" />
              </xsd:restriction>
            </xsd:simpleType>
          </xsd:attribute>
        </xsd:complexType>
      </xsd:element>
    </xsd:sequence>

    <xsd:attribute name="AuditLogTrimmingRetention" type="xsd:int" use="optional">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          The Audit Log Trimming Retention for Audits, optional attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>

    <xsd:attribute name="TrimAuditLog" type="xsd:boolean" use="optional">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          A flag to enable Audit Log Trimming, optional attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>

  </xsd:complexType>

  <xsd:complexType name="PropertyBagEntries">
    <xsd:annotation>
      <xsd:documentation xml:lang="en">
        The Property Bag entries of the Provisioning Template, optional collection of elements.
      </xsd:documentation>
    </xsd:annotation>
    <xsd:sequence>
      <xsd:element name="PropertyBagEntry" type="pnp:PropertyBagEntry"
                    minOccurs="1" maxOccurs="unbounded" />
    </xsd:sequence>
  </xsd:complexType>

  <xsd:complexType name="Security">
    <xsd:annotation>
      <xsd:documentation xml:lang="en">
        The Security configurations of the Provisioning Template, optional collection of elements.
      </xsd:documentation>
    </xsd:annotation>
    <xsd:sequence>
      <xsd:element name="AdditionalAdministrators" type="pnp:UsersList" minOccurs="0">
        <xsd:annotation>
          <xsd:documentation xml:lang="en">
            List of additional Administrators for the Site, optional collection of elements.
          </xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="AdditionalOwners" type="pnp:UsersList" minOccurs="0">
        <xsd:annotation>
          <xsd:documentation xml:lang="en">
            List of additional Owners for the Site, optional collection of elements.
          </xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="AdditionalMembers" type="pnp:UsersList" minOccurs="0">
        <xsd:annotation>
          <xsd:documentation xml:lang="en">
            List of additional Members for the Site, optional collection of elements.
          </xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="AdditionalVisitors" type="pnp:UsersList" minOccurs="0">
        <xsd:annotation>
          <xsd:documentation xml:lang="en">
            List of additional Visitors for the Site, optional collection of elements.
          </xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="SiteGroups" type="pnp:SiteGroups" minOccurs="0">
        <xsd:annotation>
          <xsd:documentation xml:lang="en">
            List of additional Groups for the Site, optional collection of elements.
          </xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="Permissions" minOccurs="0">
        <xsd:complexType>
          <xsd:sequence>
            <xsd:element name="RoleDefinitions" type="pnp:RoleDefinitions" minOccurs="0">
              <xsd:annotation>
                <xsd:documentation xml:lang="en">
                  List of Role Definitions for the Site, optional collection of elements.
                </xsd:documentation>
              </xsd:annotation>
            </xsd:element>
            <xsd:element name="RoleAssignments" type="pnp:RoleAssignments" minOccurs="0">
              <xsd:annotation>
                <xsd:documentation xml:lang="en">
                  List of Role Assignments for the Site, optional collection of elements.
                </xsd:documentation>
              </xsd:annotation>
            </xsd:element>
          </xsd:sequence>
        </xsd:complexType>
      </xsd:element>
    </xsd:sequence>
    <xsd:attribute name="BreakRoleInheritance" type="xsd:boolean" use="optional" default="false">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          Declares whether the to break role inheritance for the site, if it is a sub-site, optional attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>
    <xsd:attribute name="CopyRoleAssignments" type="xsd:boolean" use="optional" default="false">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          Defines whether to copy role assignments or not while breaking role inheritance, optional attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>
    <xsd:attribute name="ClearSubscopes" type="xsd:boolean" use="optional" default="false">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          Defines whether to clear subscopes or not while breaking role inheritance for the site, optional attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>
  </xsd:complexType>

  <xsd:complexType name="Navigation">
    <xsd:annotation>
      <xsd:documentation xml:lang="en">
        The Navigation configurations of the Provisioning Template, optional collection of elements.
      </xsd:documentation>
    </xsd:annotation>
    <xsd:sequence>
      <xsd:element name="GlobalNavigation" minOccurs="0">
        <xsd:annotation>
          <xsd:documentation xml:lang="en">
            The Global Navigation settings for the Provisioning Template, optional element.
          </xsd:documentation>
        </xsd:annotation>
        <xsd:complexType>
          <xsd:sequence>
            <xsd:element name="StructuralNavigation" type="pnp:StructuralNavigation" minOccurs="0" maxOccurs="1" />
            <xsd:element name="ManagedNavigation" type="pnp:ManagedNavigation" minOccurs="0" maxOccurs="1" />
          </xsd:sequence>
          <xsd:attribute name="NavigationType" use="optional" default="Inherit">
            <xsd:annotation>
              <xsd:documentation xml:lang="en">
                Defines the type of Global Navigation, required attribute.
              </xsd:documentation>
            </xsd:annotation>
            <xsd:simpleType>
              <xsd:restriction base="xsd:string">
                <xsd:enumeration value="Inherit">
                  <xsd:annotation>
                    <xsd:documentation xml:lang="en">
                      The site inherits the Global Navigation settings from its parent.
                    </xsd:documentation>
                  </xsd:annotation>
                </xsd:enumeration>
                <xsd:enumeration value="Structural">
                  <xsd:annotation>
                    <xsd:documentation xml:lang="en">
                      The site uses Structural Global Navigation.
                    </xsd:documentation>
                  </xsd:annotation>
                </xsd:enumeration>
                <xsd:enumeration value="Managed">
                  <xsd:annotation>
                    <xsd:documentation xml:lang="en">
                      The site uses Managed Global Navigation.
                    </xsd:documentation>
                  </xsd:annotation>
                </xsd:enumeration>
              </xsd:restriction>
            </xsd:simpleType>
          </xsd:attribute>
        </xsd:complexType>
      </xsd:element>
      <xsd:element name="CurrentNavigation" minOccurs="0">
        <xsd:annotation>
          <xsd:documentation xml:lang="en">
            The Current Navigation settings for the Provisioning Template, optional element.
          </xsd:documentation>
        </xsd:annotation>
        <xsd:complexType>
          <xsd:sequence>
            <xsd:element name="StructuralNavigation" type="pnp:StructuralNavigation" minOccurs="0" maxOccurs="1" />
            <xsd:element name="ManagedNavigation" type="pnp:ManagedNavigation" minOccurs="0" maxOccurs="1" />
          </xsd:sequence>
          <xsd:attribute name="NavigationType" use="optional" default="Inherit">
            <xsd:annotation>
              <xsd:documentation xml:lang="en">
                Defines the type of Current Navigation, required attribute.
              </xsd:documentation>
            </xsd:annotation>
            <xsd:simpleType>
              <xsd:restriction base="xsd:string">
                <xsd:enumeration value="Inherit">
                  <xsd:annotation>
                    <xsd:documentation xml:lang="en">
                      The site inherits the Current Navigation settings from its parent.
                    </xsd:documentation>
                  </xsd:annotation>
                </xsd:enumeration>
                <xsd:enumeration value="Structural">
                  <xsd:annotation>
                    <xsd:documentation xml:lang="en">
                      The site uses Structural Current Navigation.
                    </xsd:documentation>
                  </xsd:annotation>
                </xsd:enumeration>
                <xsd:enumeration value="StructuralLocal">
                  <xsd:annotation>
                    <xsd:documentation xml:lang="en">
                      The site uses Structural Local Current Navigation.
                    </xsd:documentation>
                  </xsd:annotation>
                </xsd:enumeration>
                <xsd:enumeration value="Managed">
                  <xsd:annotation>
                    <xsd:documentation xml:lang="en">
                      The site uses Managed Current Navigation.
                    </xsd:documentation>
                  </xsd:annotation>
                </xsd:enumeration>
              </xsd:restriction>
            </xsd:simpleType>
          </xsd:attribute>
        </xsd:complexType>
      </xsd:element>
    </xsd:sequence>
    <xsd:attribute name="EnableTreeView" type="xsd:boolean" use="optional" default="false">
      <xsd:annotation>
        <xsd:appinfo>Added with schema version 201705</xsd:appinfo>
        <xsd:documentation xml:lang="en">
          Declares whether the tree view has to be enabled at the site level or not, optional attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>
  </xsd:complexType>

  <xsd:complexType name="ManagedNavigation">
    <xsd:annotation>
      <xsd:documentation xml:lang="en">
        Defines the Managed Navigation settings of a site, optional element.
      </xsd:documentation>
    </xsd:annotation>
    <xsd:attribute name="TermStoreId" type="pnp:ReplaceableString" use="required">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          Defines the TermStore ID for the Managed Navigation, required attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>
    <xsd:attribute name="TermSetId" type="pnp:ReplaceableString" use="required">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          Defines the TermSet ID for the Managed Navigation, required attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>
  </xsd:complexType>

  <xsd:complexType name="StructuralNavigation">
    <xsd:annotation>
      <xsd:documentation xml:lang="en">
        Defines the Structural Navigation settings of a site.
      </xsd:documentation>
    </xsd:annotation>
    <xsd:sequence>
      <xsd:element name="NavigationNode" type="pnp:NavigationNode" minOccurs="0" maxOccurs="unbounded" />
    </xsd:sequence>
    <xsd:attribute name="RemoveExistingNodes" type="xsd:boolean" use="required">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          Defines whether to remove existing nodes before creating those described through this element, required attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>
  </xsd:complexType>

  <xsd:complexType name="NavigationNode">
    <xsd:annotation>
      <xsd:documentation xml:lang="en">
        Defines a Navigation Node for the Structural Navigation of a site.
      </xsd:documentation>
    </xsd:annotation>
    <xsd:sequence>
      <xsd:element name="NavigationNode" type="pnp:NavigationNode" minOccurs="0" maxOccurs="unbounded" />
    </xsd:sequence>
    <xsd:attribute name="Title" type="pnp:ReplaceableString" use="required">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          Defines the Title of a Navigation Node for the Structural Navigation of a site.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>
    <xsd:attribute name="Url" type="pnp:ReplaceableString" use="optional">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          Defines the Url of a Navigation Node for the Structural Navigation of a site.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>
    <xsd:attribute name="IsExternal" type="xsd:boolean" use="optional" default="false">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          Defines whether the Navigation Node for the Structural Navigation targets an External resource.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>
    <xsd:attribute name="IsVisible" type="xsd:boolean" use="optional" default="true">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          Defines whether the Navigation Node for the Structural Navigation is visible or not.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>
  </xsd:complexType>
  
  <xsd:complexType name="Features">
    <xsd:annotation>
      <xsd:documentation xml:lang="en">
        The Features (Site or Web) to activate or deactivate while applying the Provisioning Template, optional collection of elements.
      </xsd:documentation>
    </xsd:annotation>
    <xsd:sequence>
      <xsd:element name="SiteFeatures" type="pnp:FeaturesList" minOccurs="0">
        <xsd:annotation>
          <xsd:documentation xml:lang="en">
            The Site Features to activate or deactivate while applying the Provisioning Template, optional collection of elements.
          </xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="WebFeatures" type="pnp:FeaturesList" minOccurs="0">
        <xsd:annotation>
          <xsd:documentation xml:lang="en">
            The Web Features to activate or deactivate while applying the Provisioning Template, optional collection of elements.
          </xsd:documentation>
        </xsd:annotation>
      </xsd:element>
    </xsd:sequence>
  </xsd:complexType>

  <xsd:complexType name="CustomActions">
    <xsd:annotation>
      <xsd:documentation xml:lang="en">
        The Custom Actions (Site or Web) to provision with the Provisioning Template, optional element.
      </xsd:documentation>
    </xsd:annotation>
    <xsd:sequence>
      <xsd:element name="SiteCustomActions" type="pnp:CustomActionsList" minOccurs="0">
        <xsd:annotation>
          <xsd:documentation xml:lang="en">
            The Site Custom Actions to provision while applying the Provisioning Template, optional collection of elements.
          </xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="WebCustomActions" type="pnp:CustomActionsList" minOccurs="0">
        <xsd:annotation>
          <xsd:documentation xml:lang="en">
            The Web Custom Actions to provision while applying the Provisioning Template, optional collection of elements.
          </xsd:documentation>
        </xsd:annotation>
      </xsd:element>
    </xsd:sequence>
  </xsd:complexType>

  <xsd:complexType name="Pages">
    <xsd:annotation>
      <xsd:documentation xml:lang="en">
        The Pages to provision into the target Site through the Provisioning Template, optional collection of elements.
      </xsd:documentation>
    </xsd:annotation>
    <xsd:sequence>
      <xsd:element name="Page" type="pnp:Page"
                    minOccurs="1" maxOccurs="unbounded" />
    </xsd:sequence>

  </xsd:complexType>

  <xsd:complexType name="PropertyBagEntry" >
    <xsd:annotation>
      <xsd:documentation xml:lang="en">
        The Property Bag Entry of the Provisioning Template.
      </xsd:documentation>
    </xsd:annotation>
    <xsd:complexContent>
      <xsd:extension base="pnp:StringDictionaryItem">
        <xsd:attribute name="Overwrite" type="xsd:boolean" use="optional">
          <xsd:annotation>
            <xsd:documentation xml:lang="en">
              Declares whether the Property Bag Entry has to overwrite an already existing entry, optional attribute.
            </xsd:documentation>
          </xsd:annotation>
        </xsd:attribute>
        <xsd:attribute name="Indexed" type="xsd:boolean" use="optional" default="false">
          <xsd:annotation>
            <xsd:documentation xml:lang="en">
              Declares whether the Property Bag Entry has to be indexed, optional attribute.
            </xsd:documentation>
          </xsd:annotation>
        </xsd:attribute>
      </xsd:extension>
    </xsd:complexContent>
  </xsd:complexType>

  <xsd:complexType name="StringDictionaryItem">
    <xsd:annotation>
      <xsd:documentation xml:lang="en">
        Defines a StringDictionary element.
      </xsd:documentation>
    </xsd:annotation>

    <xsd:attribute name="Key" type="xsd:string" use="required">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          The Key of the property to store in the StringDictionary, required attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>

    <xsd:attribute name="Value" type="xsd:string" use="required">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          The Value of the property to store in the StringDictionary, required attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>

  </xsd:complexType>

  <xsd:complexType name="UsersList">
    <xsd:annotation>
      <xsd:documentation xml:lang="en">
        List of Users for the Site Security, collection of elements.
      </xsd:documentation>
    </xsd:annotation>

    <xsd:sequence>
      <xsd:element name="User" type="pnp:User" maxOccurs="unbounded" />
    </xsd:sequence>

  </xsd:complexType>

  <xsd:complexType name="User">
    <xsd:annotation>
      <xsd:documentation xml:lang="en">
        The base type for a User element.
      </xsd:documentation>
    </xsd:annotation>

    <xsd:attribute name="Name" type="xsd:string" use="required">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          The Name of the User, required attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>

  </xsd:complexType>

  <xsd:complexType name="SiteGroups">
    <xsd:annotation>
      <xsd:documentation xml:lang="en">
        List of Site Groups for the Site Security, collection of elements.
      </xsd:documentation>
    </xsd:annotation>

    <xsd:sequence>
      <xsd:element name="SiteGroup" type="pnp:SiteGroup" maxOccurs="unbounded" />
    </xsd:sequence>

  </xsd:complexType>

  <xsd:complexType name="SiteGroup">
    <xsd:annotation>
      <xsd:documentation xml:lang="en">
        The base type for a Site Group element.
      </xsd:documentation>
    </xsd:annotation>

    <xsd:sequence>
      <xsd:element name="Members" type="pnp:UsersList" minOccurs="0" maxOccurs="1">
        <xsd:annotation>
          <xsd:documentation xml:lang="en">
            The list of members of the Site Group, optional element.
          </xsd:documentation>
        </xsd:annotation>
      </xsd:element>
    </xsd:sequence>

    <xsd:attribute name="Title" type="xsd:string" use="required">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          The Title of the Site Group, required attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>

    <xsd:attribute name="Description" type="xsd:string" use="optional">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          The Description of the Site Group, optional attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>

    <xsd:attribute name="Owner" type="xsd:string" use="required">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          The Owner of the Site Group, required attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>

    <xsd:attribute name="AllowMembersEditMembership" type="xsd:boolean" use="optional">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          Defines whether the members can edit membership of the Site Group, optional attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>

    <xsd:attribute name="AllowRequestToJoinLeave" type="xsd:boolean" use="optional">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          Defines whether to allow requests to join or leave the Site Group, optional attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>

    <xsd:attribute name="AutoAcceptRequestToJoinLeave" type="xsd:boolean" use="optional">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          Defines whether to auto-accept requests to join or leave the Site Group, optional attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>

    <xsd:attribute name="OnlyAllowMembersViewMembership" type="xsd:boolean" use="optional">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          Defines whether to allow members only to view the membership of the Site Group, optional attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>

    <xsd:attribute name="RequestToJoinLeaveEmailSetting" type="xsd:string" use="optional">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          Defines the email address used for membership requests to join or leave will be sent for the Site Group, optional attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>

  </xsd:complexType>

  <xsd:complexType name="RoleDefinitions">
    <xsd:annotation>
      <xsd:documentation xml:lang="en">
        List of Role Definitions for a target RoleAssignment, collection of elements.
      </xsd:documentation>
    </xsd:annotation>

    <xsd:sequence>
      <xsd:element name="RoleDefinition" type="pnp:RoleDefinition" maxOccurs="unbounded" />
    </xsd:sequence>

  </xsd:complexType>

  <xsd:complexType name="RoleDefinition">

    <xsd:sequence>
      <xsd:element name="Permissions" minOccurs="1" maxOccurs="1">
        <xsd:annotation>
          <xsd:documentation xml:lang="en">
            Defines the Permissions of the Role Definition, required element.
          </xsd:documentation>
        </xsd:annotation>

        <xsd:complexType>
          <xsd:sequence>
            <xsd:element name="Permission" minOccurs="1" maxOccurs="unbounded">
              <xsd:annotation>
                <xsd:documentation xml:lang="en">
                  Defines a Permission for a Role Definition.
                </xsd:documentation>
              </xsd:annotation>
              <xsd:simpleType>
                <xsd:annotation>
                  <xsd:documentation xml:lang="en">
                    Available Permissions for a Permission of a Role Definition.
                  </xsd:documentation>
                </xsd:annotation>
                <xsd:restriction base="xsd:string">
                  <xsd:enumeration value="EmptyMask" />
                  <xsd:enumeration value="ViewListItems" />
                  <xsd:enumeration value="AddListItems" />
                  <xsd:enumeration value="EditListItems" />
                  <xsd:enumeration value="DeleteListItems" />
                  <xsd:enumeration value="ApproveItems" />
                  <xsd:enumeration value="OpenItems" />
                  <xsd:enumeration value="ViewVersions" />
                  <xsd:enumeration value="DeleteVersions" />
                  <xsd:enumeration value="CancelCheckout" />
                  <xsd:enumeration value="ManagePersonalViews" />
                  <xsd:enumeration value="ManageLists" />
                  <xsd:enumeration value="ViewFormPages" />
                  <xsd:enumeration value="AnonymousSearchAccessList" />
                  <xsd:enumeration value="Open" />
                  <xsd:enumeration value="ViewPages" />
                  <xsd:enumeration value="AddAndCustomizePages" />
                  <xsd:enumeration value="ApplyThemeAndBorder" />
                  <xsd:enumeration value="ApplyStyleSheets" />
                  <xsd:enumeration value="ViewUsageData" />
                  <xsd:enumeration value="CreateSSCSite" />
                  <xsd:enumeration value="ManageSubwebs" />
                  <xsd:enumeration value="CreateGroups" />
                  <xsd:enumeration value="ManagePermissions" />
                  <xsd:enumeration value="BrowseDirectories" />
                  <xsd:enumeration value="BrowseUserInfo" />
                  <xsd:enumeration value="AddDelPrivateWebParts" />
                  <xsd:enumeration value="UpdatePersonalWebParts" />
                  <xsd:enumeration value="ManageWeb" />
                  <xsd:enumeration value="AnonymousSearchAccessWebLists" />
                  <xsd:enumeration value="UseClientIntegration" />
                  <xsd:enumeration value="UseRemoteAPIs" />
                  <xsd:enumeration value="ManageAlerts" />
                  <xsd:enumeration value="CreateAlerts" />
                  <xsd:enumeration value="EditMyUserInfo" />
                  <xsd:enumeration value="EnumeratePermissions" />
                  <xsd:enumeration value="FullMask" />
                </xsd:restriction>
              </xsd:simpleType>
            </xsd:element>
          </xsd:sequence>
        </xsd:complexType>

      </xsd:element>
    </xsd:sequence>

    <xsd:attribute name="Name" type="xsd:string" use="required">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          Defines the Name of the Role Definition, required attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>

    <xsd:attribute name="Description" type="xsd:string" use="optional">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          Defines the Description of the Role Definition, optional attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>

  </xsd:complexType>

  <xsd:complexType name="RoleAssignments">
    <xsd:annotation>
      <xsd:documentation xml:lang="en">
        List of Role Assignments for a target Principal, collection of elements.
      </xsd:documentation>
    </xsd:annotation>

    <xsd:sequence>
      <xsd:element name="RoleAssignment" type="pnp:RoleAssignment" maxOccurs="unbounded" />
    </xsd:sequence>

  </xsd:complexType>

  <xsd:complexType name="RoleAssignment">

    <xsd:attribute name="Principal" type="xsd:string" use="required">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          Defines the Role to which the assignment will apply, required attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>

    <xsd:attribute name="RoleDefinition" type="xsd:string" use="required">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          Defines the Role to which the assignment will apply, required attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>

    <xsd:attribute name="Remove" type="xsd:boolean" use="optional" default="false">
      <xsd:annotation>
        <xsd:appinfo>Added with schema version 201705</xsd:appinfo>
        <xsd:documentation xml:lang="en">
          Allows to remove a role assignment, instead of adding it. It is an optional attribute, and by default it assumes a value of false.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>

  </xsd:complexType>

  <xsd:complexType name="ObjectSecurity">
    <xsd:annotation>
      <xsd:documentation xml:lang="en">
        Defines a set of Role Assignments for specific principals.
      </xsd:documentation>
    </xsd:annotation>

    <xsd:sequence>
      <xsd:element name="BreakRoleInheritance" minOccurs="1" maxOccurs="1">
        <xsd:complexType>
          <xsd:annotation>
            <xsd:documentation xml:lang="en">
              Declares a section of custom permissions, breaking role inheritance from parent.
            </xsd:documentation>
          </xsd:annotation>

          <xsd:sequence>
            <xsd:element name="RoleAssignment" type="pnp:RoleAssignment" minOccurs="0" maxOccurs="unbounded" />
          </xsd:sequence>

          <xsd:attribute name="CopyRoleAssignments" type="xsd:boolean" use="required">
            <xsd:annotation>
              <xsd:documentation xml:lang="en">
                Defines whether to copy role assignments or not while breaking role inheritance, required attribute.
              </xsd:documentation>
            </xsd:annotation>
          </xsd:attribute>

          <xsd:attribute name="ClearSubscopes" type="xsd:boolean" use="required">
            <xsd:annotation>
              <xsd:documentation xml:lang="en">
                Defines whether to clear subscopes or not while breaking role inheritance, required attribute.
              </xsd:documentation>
            </xsd:annotation>
          </xsd:attribute>

        </xsd:complexType>
      </xsd:element>
    </xsd:sequence>


  </xsd:complexType>

  <xsd:complexType name="ListInstance">
    <xsd:annotation>
      <xsd:documentation xml:lang="en">
        Defines a ListInstance element
      </xsd:documentation>
    </xsd:annotation>

    <xsd:all>
      <xsd:element name="ContentTypeBindings" minOccurs="0">
        <xsd:annotation>
          <xsd:documentation xml:lang="en">
            The ContentTypeBindings entries of the List Instance, optional collection of elements.
          </xsd:documentation>
        </xsd:annotation>
        <xsd:complexType>
          <xsd:sequence>
            <xsd:element name="ContentTypeBinding" type="pnp:ContentTypeBinding"
                         minOccurs="1" maxOccurs="unbounded" />
          </xsd:sequence>
        </xsd:complexType>
      </xsd:element>
      <xsd:element name="Views" minOccurs="0">
        <xsd:annotation>
          <xsd:documentation xml:lang="en">
            The Views entries of the List Instance, optional collection of elements.
          </xsd:documentation>
        </xsd:annotation>
        <xsd:complexType>
          <xsd:sequence>
            <xsd:any minOccurs="1" maxOccurs="unbounded"
                     processContents="lax" namespace="##any" />
          </xsd:sequence>
          <xsd:attribute name="RemoveExistingViews" use="optional" default="false" type="xsd:boolean">
            <xsd:annotation>
              <xsd:documentation xml:lang="en">
                A flag to declare if the existing views of the List Instance have to be removed, before adding the custom views, optional attribute.
              </xsd:documentation>
            </xsd:annotation>
          </xsd:attribute>
        </xsd:complexType>
      </xsd:element>
      <xsd:element name="Fields" minOccurs="0">
        <xsd:annotation>
          <xsd:documentation xml:lang="en">
            The Fields entries of the List Instance, optional collection of elements.
          </xsd:documentation>
        </xsd:annotation>
        <xsd:complexType>
          <xsd:sequence>
            <xsd:any minOccurs="1" maxOccurs="unbounded"
                     processContents="lax" namespace="##any" />
          </xsd:sequence>
        </xsd:complexType>
      </xsd:element>
      <xsd:element name="FieldRefs" minOccurs="0">
        <xsd:annotation>
          <xsd:documentation xml:lang="en">
            The FieldRefs entries of the List Instance, optional collection of elements.
          </xsd:documentation>
        </xsd:annotation>
        <xsd:complexType>
          <xsd:sequence>
            <xsd:element name="FieldRef" type="pnp:ListInstanceFieldRef"
                         minOccurs="1" maxOccurs="unbounded" />
          </xsd:sequence>
        </xsd:complexType>
      </xsd:element>
      <xsd:element name="DataRows" maxOccurs="1" minOccurs="0">

        <xsd:annotation>
          <xsd:documentation xml:lang="en">
            Defines a collection of rows that will be added to the List Instance, optional element.
          </xsd:documentation>
        </xsd:annotation>

        <xsd:complexType>
          <xsd:sequence>
            <xsd:element name="DataRow" maxOccurs="unbounded" minOccurs="0">
              <xsd:complexType>
                <xsd:sequence>
                  <xsd:element name="DataValue" maxOccurs="unbounded" minOccurs="1" type="pnp:DataValue">
                    <xsd:annotation>
                      <xsd:documentation xml:lang="en">
                        Defines a single field to provision within a row that will be added to the List Instance, collection of elements (field values).
                      </xsd:documentation>
                    </xsd:annotation>
                  </xsd:element>
                  <xsd:element name="Security" type="pnp:ObjectSecurity" minOccurs="0" maxOccurs="1">
                    <xsd:annotation>
                      <xsd:documentation xml:lang="en">
                        Defines the security rules for the row that will be added to the List Instance, optional element.
                      </xsd:documentation>
                    </xsd:annotation>
                  </xsd:element>
                </xsd:sequence>
                <xsd:attribute name="Key" type="xsd:string" use="optional">
                  <xsd:annotation>
                    <xsd:appinfo>Added with schema version 201705</xsd:appinfo>
                    <xsd:documentation xml:lang="en">
                      Optional attribute to specify the keyvalue of the item to match. If the collection has a Key Column specified, the list will be checked if items exist where tkey Key Column matches the value specified in this attribute. See KeyColumn on the parent collection for more information.
                    </xsd:documentation>
                  </xsd:annotation>
                </xsd:attribute>
              </xsd:complexType>
            </xsd:element>
          </xsd:sequence>
          <xsd:attribute name="KeyColumn" type="xsd:string" use="optional">
            <xsd:annotation>
              <xsd:appinfo>Added with schema version 201705</xsd:appinfo>
              <xsd:documentation xml:lang="en">
                Optional attribute to declare the name of the Key Column, if any, used to identify any already existing DataRows.
                If this attribute has a value and the target list already has items with matching KeyColumn values, the engine will handle the matching DataRows based on the value of the UpdateBehavior attribute.
                If UpdateBehavior has a value of Skip, the DataRows will be skipped.
                If UpdateBehavior has a value of Overwrite, the existing items will be updated with the values defined in the DataRows.
              </xsd:documentation>
            </xsd:annotation>
          </xsd:attribute>

          <xsd:attribute name="UpdateBehavior" use="optional" default="Skip">
            <xsd:annotation>
              <xsd:appinfo>Added with schema version 201705</xsd:appinfo>
              <xsd:documentation xml:lang="en">
                If the DataRow already exists on target list, this attribute defines whether 
                the DataRow will be overwritten or skipped.
              </xsd:documentation>
            </xsd:annotation>
            <xsd:simpleType>
              <xsd:restriction base="xsd:string">
                <xsd:enumeration value="Overwrite">
                  <xsd:annotation>
                    <xsd:documentation xml:lang="en">
                      Any existing DataRow will be overwritten.
                    </xsd:documentation>
                  </xsd:annotation>
                </xsd:enumeration>
                <xsd:enumeration value="Skip">
                  <xsd:annotation>
                    <xsd:documentation xml:lang="en">
                      Any existing DataRow will be skipped.
                    </xsd:documentation>
                  </xsd:annotation>
                </xsd:enumeration>
              </xsd:restriction>
            </xsd:simpleType>        
          </xsd:attribute>

        </xsd:complexType>
      </xsd:element>
      <xsd:element name="Folders" minOccurs="0">

        <xsd:annotation>
          <xsd:documentation xml:lang="en">
            Defines a collection of folders (eventually nested) that will be provisioned into the target list/library, optional element.
          </xsd:documentation>
        </xsd:annotation>

        <xsd:complexType>
          <xsd:sequence>
            <xsd:element name="Folder" type="pnp:Folder" minOccurs="1" maxOccurs="unbounded" />
          </xsd:sequence>
        </xsd:complexType>

      </xsd:element>
      <xsd:element name="FieldDefaults" maxOccurs="1" minOccurs="0">

        <xsd:annotation>
          <xsd:documentation xml:lang="en">
            Defines a list of default values for the Fields of the List Instance, optional collection of elements.
          </xsd:documentation>
        </xsd:annotation>

        <xsd:complexType>
          <xsd:sequence>
            <xsd:element name="FieldDefault" maxOccurs="unbounded" minOccurs="1" type="pnp:FieldDefault">
              <xsd:annotation>
                <xsd:documentation xml:lang="en">
                  Defines a default value for a Field of the List Instance.
                </xsd:documentation>
              </xsd:annotation>
            </xsd:element>
          </xsd:sequence>
        </xsd:complexType>
      </xsd:element>
      <xsd:element name="Security" type="pnp:ObjectSecurity" minOccurs="0" maxOccurs="1">
        <xsd:annotation>
          <xsd:documentation xml:lang="en">
            Defines the Security rules for the List Instance, optional element.
          </xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="UserCustomActions" type="pnp:CustomActionsList" minOccurs="0" maxOccurs="1">
        <xsd:annotation>
          <xsd:documentation xml:lang="en">
            Defines any Custom Action for the List Instance, optional element.
          </xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="Webhooks" type="pnp:WebhooksList" minOccurs="0" maxOccurs="1">
        <xsd:annotation>
          <xsd:appinfo>Added with schema version 201705</xsd:appinfo>
          <xsd:documentation xml:lang="en">
            Defines any Webhook for the current list instance.
          </xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="IRMSettings" type="pnp:IRMSettings" minOccurs="0" maxOccurs="1">
          <xsd:annotation>
            <xsd:appinfo>Added with schema version 201705</xsd:appinfo>
            <xsd:documentation xml:lang="en">
              Declares the Information Rights Management settings for the list or library.
            </xsd:documentation>
          </xsd:annotation>
      </xsd:element>
    </xsd:all>

    <xsd:attribute name="Title" type="xsd:string" use="required">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          The Title of the List Instance, required attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>

    <xsd:attribute name="Description" type="xsd:string" use="optional">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          The Description of the List Instance, optional attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>

    <xsd:attribute name="DocumentTemplate" type="xsd:string" use="optional">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          The DocumentTemplate of the List Instance, optional attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>

    <xsd:attribute name="OnQuickLaunch" type="xsd:boolean" use="optional" default="false">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          The OnQuickLaunch flag for the List Instance, optional attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>

    <xsd:attribute name="TemplateType" type="xsd:int" use="required">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          The TemplateType of the List Instance, required attribute.
          Values available here: https://msdn.microsoft.com/en-us/library/office/microsoft.sharepoint.client.listtemplatetype.aspx
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>

    <xsd:attribute name="Url" type="xsd:string" use="required">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          The Url of the List Instance, required attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>

    <xsd:attribute name="ForceCheckout" type="xsd:boolean" use="optional" default="false">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          The ForceCheckout flag for the List Instance, optional attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>

    <xsd:attribute name="EnableVersioning" type="xsd:boolean" use="optional" default="false">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          The EnableVersioning flag for the List Instance, optional attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>

    <xsd:attribute name="EnableMinorVersions" type="xsd:boolean" use="optional" default="false">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          The EnableMinorVersions flag for the List Instance, optional attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>

    <xsd:attribute name="EnableModeration" type="xsd:boolean" use="optional" default="false">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          The EnableModeration flag for the List Instance, optional attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>

    <xsd:attribute name="MinorVersionLimit" type="xsd:int" use="optional">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          The MinorVersionLimit for versions history for the List Instance, optional attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>

    <xsd:attribute name="MaxVersionLimit" type="xsd:int" use="optional">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          The MaxVersionLimit for versions history for the List Instance, optional attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>

    <xsd:attribute name="DraftVersionVisibility" type="xsd:int" use="optional">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          The DraftVersionVisibility for the List Instance, optional attribute. The property will be cast to enum DraftVersionVisibility
          0 - Reader - 	Any user who can read items,
          1 - Author - Only users who can edit items,
          2 - Approver - Only users who can approve items (and the author of the item)
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>

    <xsd:attribute name="RemoveExistingContentTypes" type="xsd:boolean" use="optional" default="false">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          The RemoveExistingContentTypes flag for the List Instance, optional attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>

    <xsd:attribute name="TemplateFeatureID" type="pnp:GUID" use="optional">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          The TemplateFeatureID for the feature on which the List Instance is based, optional attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>

    <xsd:attribute name="ContentTypesEnabled" type="xsd:boolean" use="optional" default="false">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          The ContentTypesEnabled flag for the List Instance, optional attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>

    <xsd:attribute name="Hidden" type="xsd:boolean" use="optional" default="false">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          The Hidden flag for the List Instance, optional attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>

    <xsd:attribute name="EnableAttachments" type="xsd:boolean" use="optional" default="true">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          The EnableAttachments flag for the List Instance, optional attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>

    <xsd:attribute name="EnableFolderCreation" type="xsd:boolean" use="optional" default="true">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          The EnableFolderCreation flag for the List Instance, optional attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>

    <xsd:attribute name="NoCrawl" type="xsd:boolean" use="optional" default="false">
      <xsd:annotation>
        <xsd:appinfo>Added with schema version 201705</xsd:appinfo>
        <xsd:documentation xml:lang="en">
          Defines if the current list or library has to be included in crawling, optional attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>

    <xsd:attribute name="ListExperience" use="optional" default="Auto">
      <xsd:annotation>
        <xsd:appinfo>Added with schema version 201705</xsd:appinfo>
        <xsd:documentation xml:lang="en">
          Defines the current list UI/UX experience (valid for SPO only).
        </xsd:documentation>
      </xsd:annotation>
      <xsd:simpleType>
        <xsd:restriction base="xsd:string">
          <xsd:enumeration value="Auto">
            <xsd:annotation>
              <xsd:documentation xml:lang="en">
                SPO will automatically define the right experience based on the settings of the current list, it is the default value.
              </xsd:documentation>
            </xsd:annotation>
          </xsd:enumeration>
          <xsd:enumeration value="ClassicExperience">
            <xsd:annotation>
              <xsd:documentation xml:lang="en">
                The Classic experience will be forced for the current list.
              </xsd:documentation>
            </xsd:annotation>
          </xsd:enumeration>
          <xsd:enumeration value="NewExperience">
            <xsd:annotation>
              <xsd:documentation xml:lang="en">
                The Modern experience will be forced for the current list.
              </xsd:documentation>
            </xsd:annotation>
          </xsd:enumeration>
        </xsd:restriction>
      </xsd:simpleType>
    </xsd:attribute>

    <xsd:attribute name="DefaultDisplayFormUrl" type="xsd:string" use="optional">
      <xsd:annotation>
        <xsd:appinfo>Added with schema version 201705</xsd:appinfo>
        <xsd:documentation xml:lang="en">
          Defines a value that specifies the location of the default display form for the list.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>

    <xsd:attribute name="DefaultEditFormUrl" type="xsd:string" use="optional">
      <xsd:annotation>
        <xsd:appinfo>Added with schema version 201705</xsd:appinfo>
        <xsd:documentation xml:lang="en">
          Defines a value that specifies the URL of the edit form to use for list items in the list.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>

    <xsd:attribute name="DefaultNewFormUrl" type="xsd:string" use="optional">
      <xsd:annotation>
        <xsd:appinfo>Added with schema version 201705</xsd:appinfo>
        <xsd:documentation xml:lang="en">
          Defines a value that specifies the location of the default new form for the list.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>

    <xsd:attribute name="Direction" use="optional" default="NONE">
      <xsd:annotation>
        <xsd:appinfo>Added with schema version 201705</xsd:appinfo>
        <xsd:documentation xml:lang="en">
          Defines a value that specifies the reading order of the list.
        </xsd:documentation>
      </xsd:annotation>
      <xsd:simpleType>
        <xsd:restriction base="xsd:string">
          <xsd:enumeration value="NONE">
            <xsd:annotation>
              <xsd:documentation xml:lang="en">
                None
              </xsd:documentation>
            </xsd:annotation>
          </xsd:enumeration>
          <xsd:enumeration value="LTR">
            <xsd:annotation>
              <xsd:documentation xml:lang="en">
                Left to Right
              </xsd:documentation>
            </xsd:annotation>
          </xsd:enumeration>
          <xsd:enumeration value="RTL">
            <xsd:annotation>
              <xsd:documentation xml:lang="en">
                Right to Left
              </xsd:documentation>
            </xsd:annotation>
          </xsd:enumeration>
        </xsd:restriction>
      </xsd:simpleType>
    </xsd:attribute>

    <xsd:attribute name="ImageUrl" type="xsd:string" use="optional">
      <xsd:annotation>
        <xsd:appinfo>Added with schema version 201705</xsd:appinfo>
        <xsd:documentation xml:lang="en">
          Defines a value that specifies the URI for the icon of the list, optional attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>

    <xsd:attribute name="IrmExpire" type="xsd:boolean" use="optional">
      <xsd:annotation>
        <xsd:appinfo>Added with schema version 201705</xsd:appinfo>
        <xsd:documentation xml:lang="en">
          Defines if IRM Expire property, optional attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>

    <xsd:attribute name="IrmReject" type="xsd:boolean" use="optional">
      <xsd:annotation>
        <xsd:appinfo>Added with schema version 201705</xsd:appinfo>
        <xsd:documentation xml:lang="en">
          Defines the IRM Reject property, optional attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>

    <xsd:attribute name="IsApplicationList" type="xsd:boolean" use="optional">
      <xsd:annotation>
        <xsd:appinfo>Added with schema version 201705</xsd:appinfo>
        <xsd:documentation xml:lang="en">
          Defines a value that specifies a flag that a client application can use to determine whether to display the list, optional attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>

    <xsd:attribute name="ReadSecurity" type="xsd:int" use="optional">
      <xsd:annotation>
        <xsd:appinfo>Added with schema version 201705</xsd:appinfo>
        <xsd:documentation xml:lang="en">
          Defines the Read Security property, optional attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>

    <xsd:attribute name="ValidationFormula" type="xsd:string" use="optional">
      <xsd:annotation>
        <xsd:appinfo>Added with schema version 201705</xsd:appinfo>
        <xsd:documentation xml:lang="en">
          Defines a value that specifies the data validation criteria for a list item, optional attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>

    <xsd:attribute name="ValidationMessage" type="xsd:string" use="optional">
      <xsd:annotation>
        <xsd:appinfo>Added with schema version 201705</xsd:appinfo>
        <xsd:documentation xml:lang="en">
          Defines a value that specifies the error message returned when data validation fails for a list item, optional attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>

  </xsd:complexType>

  <xsd:complexType name="IRMSettings">
    <xsd:annotation>
      <xsd:appinfo>Added with schema version 201705</xsd:appinfo>
      <xsd:documentation xml:lang="en">
        Declares the Information Rights Management settings for the list or library.
      </xsd:documentation>
    </xsd:annotation>
  
    <xsd:attribute name="Enabled" type="xsd:boolean" use="required">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          Defines whether the IRM settings have to be enabled or not.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>

    <xsd:attribute name="AllowPrint" type="xsd:boolean" use="optional" default="true">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          Defines whether a viewer can print the downloaded document.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>

    <xsd:attribute name="AllowScript" type="xsd:boolean" use="optional" default="true">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          Defines whether a viewer can run a script on the downloaded document.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>

    <xsd:attribute name="AllowWriteCopy" type="xsd:boolean" use="optional" default="true">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          Defines whether a viewer can write on a copy of the downloaded document.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>

    <xsd:attribute name="DisableDocumentBrowserView" type="xsd:boolean" use="optional" default="true">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          Defines whether to block Office Web Application Companion applications (WACs) from showing this document.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>
    
    <xsd:attribute name="DocumentAccessExpireDays" type="xsd:int" use="optional">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          Defines the number of days after which the downloaded document will expire.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>
  
    <xsd:attribute name="DocumentLibraryProtectionExpiresInDays" type="pnp:ReplaceableInt" use="optional">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          Defines the expire days for the Information Rights Management (IRM) protection of this document library will expire.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>

    <xsd:attribute name="EnableDocumentAccessExpire" type="xsd:boolean" use="optional" default="false">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          Defines whether the downloaded document will expire.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>

    <xsd:attribute name="EnableDocumentBrowserPublishingView" type="xsd:boolean" use="optional" default="true">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          Defines whether to enable Office Web Application Companion applications (WACs) to publishing view.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>

    <xsd:attribute name="EnableGroupProtection" type="xsd:boolean" use="optional" default="true">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          Defines whether the permission of the downloaded document is applicable to a group.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>

    <xsd:attribute name="EnableLicenseCacheExpire" type="xsd:boolean" use="optional" default="false">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          Defines whether a user must verify their credentials after some interval.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>
  
    <xsd:attribute name="GroupName" type="xsd:string" use="optional">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          Defines the group name (email address) that the permission is also applicable to.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>

    <xsd:attribute name="LicenseCacheExpireDays" type="xsd:int" use="optional">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          Defines the number of days that the application that opens the document caches the IRM license. When these elapse, the application will connect to the IRM server to validate the license.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>

    <xsd:attribute name="PolicyDescription" type="xsd:string" use="optional">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          Defines the permission policy description.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>
  
    <xsd:attribute name="PolicyTitle" type="xsd:string" use="optional">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          Defines the permission policy title.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>
          
  </xsd:complexType>
    
  <xsd:complexType name="Folder">
    <xsd:annotation>
      <xsd:documentation xml:lang="en">
        Defines a folder that will be provisioned into the target list/library.
      </xsd:documentation>
    </xsd:annotation>

    <xsd:sequence>
      <xsd:element name="Folder" type="pnp:Folder" minOccurs="0" maxOccurs="unbounded">
        <xsd:annotation>
          <xsd:documentation xml:lang="en">
            A child Folder of another Folder item, optional element.
          </xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="Security" type="pnp:ObjectSecurity" minOccurs="0" maxOccurs="1">
        <xsd:annotation>
          <xsd:documentation xml:lang="en">
            Defines the security rules for the row that will be added to the List Instance, optional element.
          </xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="PropertyBagEntries" type="pnp:PropertyBagEntries" minOccurs="0" maxOccurs="1">
        <xsd:annotation>
          <xsd:appinfo>Added with schema version 201705</xsd:appinfo>
          <xsd:documentation xml:lang="en">
            The Property Bag entries of the Folder, optional collection of elements.
          </xsd:documentation>
        </xsd:annotation>
      </xsd:element>
    </xsd:sequence>

    <xsd:attribute name="Name" type="xsd:string" use="required">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          The Name of the Folder, required attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>

  </xsd:complexType>

  <xsd:complexType name="BaseFieldValue">
    <xsd:annotation>
      <xsd:documentation xml:lang="en">
        The BaseFieldValue of a single field of a row to insert into a target ListInstance.
      </xsd:documentation>
    </xsd:annotation>
    <xsd:simpleContent>
      <xsd:extension base="pnp:ReplaceableString">
        <xsd:attribute name="FieldName" use="required" type="xsd:string"/>
      </xsd:extension>
    </xsd:simpleContent>
  </xsd:complexType>

  <xsd:complexType name="DataValue">
    <xsd:annotation>
      <xsd:documentation xml:lang="en">
        The DataValue of a single field of a row to insert into a target ListInstance.
      </xsd:documentation>
    </xsd:annotation>
    <xsd:complexContent>
      <xsd:extension base="BaseFieldValue" />
    </xsd:complexContent>
  </xsd:complexType>

  <xsd:complexType name="FieldDefault">
    <xsd:annotation>
      <xsd:documentation xml:lang="en">
        The FieldDefault of a single field of list or library for target ListInstance.
      </xsd:documentation>
    </xsd:annotation>
    <xsd:complexContent>
      <xsd:extension base="BaseFieldValue" />
    </xsd:complexContent>
  </xsd:complexType>

  <xsd:complexType name="ContentType">
    <xsd:annotation>
      <xsd:documentation xml:lang="en">
        Defines a Content Type.
      </xsd:documentation>
    </xsd:annotation>

    <xsd:all>
      <xsd:element name="FieldRefs" minOccurs="0">
        <xsd:annotation>
          <xsd:documentation xml:lang="en">
            The FieldRefs entries of the List Instance, optional collection of elements.
          </xsd:documentation>
        </xsd:annotation>
        <xsd:complexType>
          <xsd:sequence>
            <xsd:element name="FieldRef" type="pnp:ContentTypeFieldRef"
                         minOccurs="1" maxOccurs="unbounded" />
          </xsd:sequence>
        </xsd:complexType>
      </xsd:element>

      <xsd:element name="DocumentTemplate" minOccurs="0" maxOccurs="1">
        <xsd:annotation>
          <xsd:documentation xml:lang="en">
            Specifies the document template for the content type. This is the file which SharePoint Foundation opens as a template when a user requests a new item of this content type.
          </xsd:documentation>
        </xsd:annotation>
        <xsd:complexType>
          <xsd:attribute name="TargetName" type="xsd:string" use="required">
            <xsd:annotation>
              <xsd:documentation xml:lang="en">
                The value of the Content Type ID, required attribute.
              </xsd:documentation>
            </xsd:annotation>
          </xsd:attribute>
        </xsd:complexType>
      </xsd:element>

      <xsd:element name="DocumentSetTemplate" type="pnp:DocumentSetTemplate" minOccurs="0">
        <xsd:annotation>
          <xsd:documentation xml:lang="en">
            Specifies the properties of the DocumentSet Template if the ContentType defines a DocumentSet.
          </xsd:documentation>
        </xsd:annotation>
      </xsd:element>

    </xsd:all>

    <xsd:attribute name="ID" type="pnp:ContentTypeId" use="required">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          The value of the Content Type ID, required attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>

    <xsd:attribute name="Name" type="xsd:string" use="required">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          The Name of the Content Type, required attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>

    <xsd:attribute name="Description" type="xsd:string" use="optional">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          The Description of the Content Type, optional attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>

    <xsd:attribute name="Group" type="xsd:string" use="optional">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          The Group of the Content Type, optional attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>

    <xsd:attribute name="Hidden" type="xsd:boolean" use="optional" default="false">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          Optional Boolean. True to define the content type as hidden. If you define a content type as hidden, SharePoint Foundation does not display that content type on the New button in list views.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>

    <xsd:attribute name="Sealed" type="xsd:boolean" use="optional" default="false">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          Optional Boolean. True to prevent changes to this content type. You cannot change the value of this attribute through the user interface, but you can change it in code if you have sufficient rights. You must have site collection administrator rights to unseal a content type.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>

    <xsd:attribute name="ReadOnly" type="xsd:boolean" use="optional" default="false">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          Optional Boolean. TRUE to specify that the content type cannot be edited without explicitly removing the read-only setting. This can be done either in the user interface or in code.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>

    <xsd:attribute name="Overwrite" type="xsd:boolean" use="optional" default="false">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          Optional Boolean. TRUE to overwrite an existing content type with the same ID.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>

    <xsd:attribute name="NewFormUrl" type="xsd:string" use="optional">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          Specifies the URL of a custom new form to use for list items that have been assigned the content type, optional attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>

    <xsd:attribute name="EditFormUrl" type="xsd:string" use="optional">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          Specifies the URL of a custom edit form to use for list items that have been assigned the content type, optional attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>

    <xsd:attribute name="DisplayFormUrl" type="xsd:string" use="optional">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          Specifies the URL of a custom display form to use for list items that have been assigned the content type, optional attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>

    <xsd:anyAttribute processContents="skip"/>

  </xsd:complexType>

  <xsd:complexType name="ContentTypeBinding">
    <xsd:annotation>
      <xsd:documentation xml:lang="en">
        Defines the binding between a ListInstance and a ContentType.
      </xsd:documentation>
    </xsd:annotation>

    <xsd:attribute name="ContentTypeID" type="pnp:ContentTypeId" use="required">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          The value of the Content Type ID to bind, required attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>

    <xsd:attribute name="Default" type="xsd:boolean" use="optional" default="false">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          Declares if the Content Type should be the default Content Type in the list or library, optional attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>

    <xsd:attribute name="Remove" type="xsd:boolean" use="optional" default="false">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          Declares if the Content Type should be Removed from the list or library, optional attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>

    <xsd:attribute name="Hidden" type="xsd:boolean" use="optional" default="false">
      <xsd:annotation>
        <xsd:appinfo>Added with schema version 201705</xsd:appinfo>
        <xsd:documentation xml:lang="en">
          Declares if the Content Type should be Hidden from New button of the list or library, optional attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>

  </xsd:complexType>

  <xsd:complexType name="DocumentSetTemplate">
    <xsd:annotation>
      <xsd:documentation xml:lang="en">
        Defines a DocumentSet Template for creating multiple DocumentSet instances.
      </xsd:documentation>
    </xsd:annotation>

    <xsd:sequence>
      <xsd:element name="AllowedContentTypes" minOccurs="0" maxOccurs="1">
        <xsd:complexType>
          <xsd:annotation>
            <xsd:documentation xml:lang="en">
              The list of allowed Content Types for the Document Set, optional element.
            </xsd:documentation>
          </xsd:annotation>
          <xsd:sequence>
            <xsd:element name="AllowedContentType" minOccurs="1" maxOccurs="unbounded">
              <xsd:complexType>
                <xsd:attribute name="ContentTypeID" type="pnp:ContentTypeId" use="required">
                  <xsd:annotation>
                    <xsd:documentation xml:lang="en">
                      The value of the ContentTypeID to allow for the Document Set, required attribute.
                    </xsd:documentation>
                  </xsd:annotation>
                </xsd:attribute>
              </xsd:complexType>
            </xsd:element>
          </xsd:sequence>

          <xsd:attribute name="RemoveExistingContentTypes" type="xsd:boolean" use="optional" default="false">
            <xsd:annotation>
              <xsd:appinfo>Added with schema version 201705</xsd:appinfo>
              <xsd:documentation xml:lang="en">
                The RemoveExistingContentTypes flag for the Allowed Content Types of the current Document Set, optional attribute.
              </xsd:documentation>
            </xsd:annotation>
          </xsd:attribute>

      </xsd:complexType>
      </xsd:element>
      <xsd:element name="DefaultDocuments" minOccurs="0" maxOccurs="1">
        <xsd:complexType>
          <xsd:annotation>
            <xsd:documentation xml:lang="en">
              The list of default Documents for the Document Set, optional element.
            </xsd:documentation>
          </xsd:annotation>
          <xsd:sequence>
            <xsd:element name="DefaultDocument" minOccurs="1" maxOccurs="unbounded">
              <xsd:complexType>
                <xsd:attribute name="Name" type="xsd:string" use="required">
                  <xsd:annotation>
                    <xsd:documentation xml:lang="en">
                      The name (including the relative path) of the Default Document for a Document Set, required attribute.
                    </xsd:documentation>
                  </xsd:annotation>
                </xsd:attribute>
                <xsd:attribute name="ContentTypeID" type="pnp:ContentTypeId" use="required">
                  <xsd:annotation>
                    <xsd:documentation xml:lang="en">
                      The value of the ContentTypeID of the Default Document for the Document Set, required attribute.
                    </xsd:documentation>
                  </xsd:annotation>
                </xsd:attribute>
                <xsd:attribute name="FileSourcePath" type="pnp:ReplaceableString" use="required">
                  <xsd:annotation>
                    <xsd:documentation xml:lang="en">
                      The path of the file to upload as a Default Document for the Document Set, required attribute.
                    </xsd:documentation>
                  </xsd:annotation>
                </xsd:attribute>
              </xsd:complexType>
            </xsd:element>
          </xsd:sequence>
        </xsd:complexType>
      </xsd:element>
      <xsd:element name="SharedFields" minOccurs="0" maxOccurs="1">
        <xsd:complexType>
          <xsd:annotation>
            <xsd:documentation xml:lang="en">
              The list of Shared Fields for the Document Set, optional element.
            </xsd:documentation>
          </xsd:annotation>
          <xsd:sequence>
            <xsd:element name="SharedField" type="pnp:DocumentSetFieldRef"
                         minOccurs="1" maxOccurs="unbounded" />
          </xsd:sequence>
        </xsd:complexType>
      </xsd:element>
      <xsd:element name="WelcomePageFields" minOccurs="0" maxOccurs="1">
        <xsd:complexType>
          <xsd:annotation>
            <xsd:documentation xml:lang="en">
              The list of Welcome Page Fields for the Document Set, optional element.
            </xsd:documentation>
          </xsd:annotation>
          <xsd:sequence>
            <xsd:element name="WelcomePageField" type="pnp:DocumentSetFieldRef"
                         minOccurs="1" maxOccurs="unbounded" />
          </xsd:sequence>
        </xsd:complexType>
      </xsd:element>
    </xsd:sequence>

    <xsd:attribute name="WelcomePage" type="xsd:string" use="optional">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          Defines the custom WelcomePage for the Document Set, optional attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>

  </xsd:complexType>

  <xsd:complexType name="FeaturesList">
    <xsd:annotation>
      <xsd:documentation xml:lang="en">
        Defines a collection of elements of type Feature.
      </xsd:documentation>
    </xsd:annotation>

    <xsd:sequence>
      <xsd:element name="Feature" type="pnp:Feature"
                   minOccurs="1" maxOccurs="unbounded" />
    </xsd:sequence>

  </xsd:complexType>

  <xsd:complexType name="Feature">
    <xsd:annotation>
      <xsd:documentation xml:lang="en">
        Defines a single Site or Web Feature, which will be activated or deactivated while applying the Provisioning Template.
      </xsd:documentation>
    </xsd:annotation>

    <xsd:attribute name="ID" type="pnp:GUID" use="required">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          The unique ID of the Feature, required attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>

    <xsd:attribute name="Deactivate" type="xsd:boolean" use="optional" default="false">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          Defines if the feature has to be deactivated or activated while applying the Provisioning Template, optional attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>

    <xsd:attribute name="Description" type="xsd:string" use="optional">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          The Description of the feature, optional attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>

  </xsd:complexType>

  <xsd:complexType name="FieldRefBase">
    <xsd:attribute name="ID" type="pnp:GUID" use="required">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          The value of the field ID to bind, required attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>
  </xsd:complexType>

  <xsd:complexType name="FieldRefFull">
    <xsd:complexContent>
      <xsd:extension base="pnp:FieldRefBase">
        <xsd:attributeGroup ref="pnp:FieldRefAttributes" />
      </xsd:extension>
    </xsd:complexContent>
  </xsd:complexType>

  <xsd:attributeGroup name="FieldRefAttributes">
    <xsd:annotation>
      <xsd:documentation xml:lang="en">
        Common set of attributes for any FieldRef element.
      </xsd:documentation>
    </xsd:annotation>

    <xsd:attribute name="Name" type="xsd:string" use="optional">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          The name of the field used in the field reference. This is for reference/readibility only.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>

    <xsd:attribute name="Required" type="xsd:boolean" use="optional" default="false">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          The Required flag for the field to bind, optional attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>

    <xsd:attribute name="Hidden" type="xsd:boolean" use="optional" default="false">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          The Hidden flag for the field to bind, optional attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>

  </xsd:attributeGroup>

  <xsd:complexType name="ListInstanceFieldRef">
    <xsd:annotation>
      <xsd:documentation xml:lang="en">
        Defines the binding between a ListInstance and a Field.
      </xsd:documentation>
    </xsd:annotation>
    <xsd:complexContent>
      <xsd:extension base="pnp:FieldRefFull">
        <xsd:attribute name="DisplayName" type="xsd:string" use="optional">
          <xsd:annotation>
            <xsd:documentation xml:lang="en">
              The display name of the field to bind, only applicable to fields that will be added to lists, optional attribute.
            </xsd:documentation>
          </xsd:annotation>
        </xsd:attribute>
        <xsd:attribute name="Remove" type="xsd:boolean" use="optional" default="false">
          <xsd:annotation>
            <xsd:appinfo>Added with schema version 201705</xsd:appinfo>
            <xsd:documentation xml:lang="en">
              Declares if the FieldRef should be Removed from the list or library, optional attribute.
            </xsd:documentation>
          </xsd:annotation>
        </xsd:attribute>
      </xsd:extension>
    </xsd:complexContent>
  </xsd:complexType>

  <xsd:complexType name="ContentTypeFieldRef">
    <xsd:annotation>
      <xsd:documentation xml:lang="en">
        Defines the binding between a ContentType and a Field.
      </xsd:documentation>
    </xsd:annotation>
    <xsd:complexContent>
      <xsd:extension base="pnp:FieldRefFull" />
    </xsd:complexContent>
  </xsd:complexType>

  <xsd:complexType name="DocumentSetFieldRef">
    <xsd:annotation>
      <xsd:documentation xml:lang="en">
        Defines the binding between a Document Set and a Field.
      </xsd:documentation>
    </xsd:annotation>
    <xsd:complexContent>
      <xsd:extension base="pnp:FieldRefBase" />
    </xsd:complexContent>
  </xsd:complexType>

  <xsd:complexType name="CustomActionsList">
    <xsd:annotation>
      <xsd:documentation xml:lang="en">
        Defines a collection of elements of type CustomAction.
      </xsd:documentation>
    </xsd:annotation>

    <xsd:sequence>
      <xsd:element name="CustomAction" type="pnp:CustomAction"
                   minOccurs="1" maxOccurs="unbounded" />
    </xsd:sequence>

  </xsd:complexType>

  <xsd:complexType name="CustomAction">
    <xsd:annotation>
      <xsd:documentation xml:lang="en">
        Defines a Custom Action, which will be provisioned while applying the Provisioning Template.
      </xsd:documentation>
    </xsd:annotation>

    <xsd:sequence>
      <xsd:element name="CommandUIExtension" minOccurs="0" maxOccurs="1">
        <xsd:annotation>
          <xsd:documentation xml:lang="en">
            Defines the Custom UI Extension XML, optional element.
          </xsd:documentation>
        </xsd:annotation>
        <xsd:complexType>
          <xsd:sequence>
            <xsd:any minOccurs="0" maxOccurs="unbounded" processContents="lax" />
          </xsd:sequence>
        </xsd:complexType>
      </xsd:element>
    </xsd:sequence>

    <xsd:attribute name="Name" type="xsd:string" use="required">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          The Name of the CustomAction, required attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>

    <xsd:attribute name="Description" type="xsd:string" use="optional">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          The Description of the CustomAction, optional attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>

    <xsd:attribute name="Group" type="xsd:string" use="optional">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          The Group of the CustomAction, optional attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>

    <xsd:attribute name="Location" type="xsd:string" use="required">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          The Location of the CustomAction, required attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>

    <xsd:attribute name="Title" type="xsd:string" use="optional">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          The Title of the CustomAction, required attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>

    <xsd:attribute name="Sequence" type="xsd:int" use="optional">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          The Sequence of the CustomAction, optional attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>

    <xsd:attribute name="Rights" type="xsd:string" use="optional">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          The Rights for the CustomAction, based on values from Microsoft.SharePoint.Client.PermissionKind, optional attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>

    <xsd:attribute name="Url" type="xsd:string" use="optional">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          The URL of the CustomAction, optional attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>

    <xsd:attribute name="Enabled" type="xsd:boolean" use="optional" default="true">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          The Enabled flag for the CustomAction, optional attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>

    <xsd:attribute name="Remove" type="xsd:boolean" use="optional" default="false">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          To Remove a CustomAction, optional attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>

    <xsd:attribute name="ScriptBlock" type="xsd:string" use="optional">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          The ScriptBlock of the CustomAction, optional attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>

    <xsd:attribute name="ImageUrl" type="xsd:string" use="optional">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          The ImageUrl of the CustomAction, optional attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>

    <xsd:attribute name="ScriptSrc" type="xsd:string" use="optional">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          The ScriptSrc of the CustomAction, optional attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>

    <xsd:attribute name="RegistrationId" type="xsd:string" use="optional">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          The RegistrationId of the CustomAction, optional attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>

    <xsd:attribute name="RegistrationType" type="pnp:RegistrationType" use="optional">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          The RegistrationType of the CustomAction, optional attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>

    <xsd:attribute name="ClientSideComponentId" type="xsd:string" use="optional">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          The Client-Side Component Id of a customizer, optional attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>

    <xsd:attribute name="ClientSideComponentProperties" type="xsd:string" use="optional">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          The Client-Side Component Properties of a customizer, optional attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>

  </xsd:complexType>

  <xsd:complexType name="SiteWebhooksList">
    <xsd:annotation>
      <xsd:appinfo>Added with schema version 201705</xsd:appinfo>
      <xsd:documentation xml:lang="en">
        Defines a collection of elements of type SiteWebhook.
      </xsd:documentation>
    </xsd:annotation>

    <xsd:sequence>
      <xsd:element name="Webhook" type="pnp:SiteWebhook"
                   minOccurs="1" maxOccurs="unbounded" />
    </xsd:sequence>

  </xsd:complexType>
  
  <xsd:complexType name="WebhooksList">
    <xsd:annotation>
      <xsd:appinfo>Added with schema version 201705</xsd:appinfo>
      <xsd:documentation xml:lang="en">
        Defines a collection of elements of type Webhook.
      </xsd:documentation>
    </xsd:annotation>

    <xsd:sequence>
      <xsd:element name="Webhook" type="pnp:Webhook"
                   minOccurs="1" maxOccurs="unbounded" />
    </xsd:sequence>

  </xsd:complexType>

  <xsd:complexType name="Webhook">
    <xsd:annotation>
      <xsd:appinfo>Added with schema version 201705</xsd:appinfo>
      <xsd:documentation xml:lang="en">
        Defines a single element of type Webhook.
      </xsd:documentation>
    </xsd:annotation>

    <xsd:attribute name="ServerNotificationUrl" type="pnp:ReplaceableString" use="required">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          The Server Notification URL of the Webhook, required attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>

    <xsd:attribute name="ExpiresInDays" type="pnp:ReplaceableInt" use="required">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          The expire days for the subscription of the Webhook, required attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>

  </xsd:complexType>
  
  <xsd:complexType name="SiteWebhook">
    <xsd:annotation>
      <xsd:appinfo>Added with schema version 201705</xsd:appinfo>
      <xsd:documentation xml:lang="en">
        Defines a single element of type SiteWebhook.
      </xsd:documentation>
    </xsd:annotation>
    <xsd:complexContent>
      <xsd:extension base="pnp:Webhook">
        <xsd:attribute name="SiteWebhookType">
          <xsd:simpleType>
            <xsd:restriction base="xsd:string">
              <xsd:enumeration value="WebCreated">
                <xsd:annotation>
                  <xsd:documentation xml:lang="en">
                    A WebHook for the WebCreated event of Site.
                  </xsd:documentation>
                </xsd:annotation>
              </xsd:enumeration>
              <xsd:enumeration value="WebMoved">
                <xsd:annotation>
                  <xsd:documentation xml:lang="en">
                    A WebHook for the WebMoved event of Site.
                  </xsd:documentation>
                </xsd:annotation>
              </xsd:enumeration>
              <xsd:enumeration value="WebDeleted">
                <xsd:annotation>
                  <xsd:documentation xml:lang="en">
                    A WebHook for the WebDeleted event of Site.
                  </xsd:documentation>
                </xsd:annotation>
              </xsd:enumeration>
              <xsd:enumeration value="ListAdded">
                <xsd:annotation>
                  <xsd:documentation xml:lang="en">
                    A WebHook for the ListAdded event of Site.
                  </xsd:documentation>
                </xsd:annotation>
              </xsd:enumeration>
              <xsd:enumeration value="ListCreated">
                <xsd:annotation>
                  <xsd:documentation xml:lang="en">
                    A WebHook for the ListCreated event of Site.
                  </xsd:documentation>
                </xsd:annotation>
              </xsd:enumeration>
            </xsd:restriction>
          </xsd:simpleType>
        </xsd:attribute>
      </xsd:extension>
    </xsd:complexContent>
  </xsd:complexType>

  <xsd:complexType name="ClientSidePages">
    <xsd:annotation>
      <xsd:appinfo>Added with schema version 201705</xsd:appinfo>
      <xsd:documentation xml:lang="en">
        Defines a collection of elements of type ClientSidePage.
      </xsd:documentation>
    </xsd:annotation>

    <xsd:sequence>
      <xsd:element name="ClientSidePage" type="pnp:ClientSidePage"
                   minOccurs="1" maxOccurs="unbounded" />
    </xsd:sequence>

  </xsd:complexType>

  <xsd:complexType name="ClientSidePage">
    <xsd:annotation>
      <xsd:appinfo>Added with schema version 201705</xsd:appinfo>
      <xsd:documentation xml:lang="en">
        Defines a single element of type ClientSidePage.
      </xsd:documentation>
    </xsd:annotation>

    <xsd:sequence>

      <xsd:element name="Sections" minOccurs="0" maxOccurs="1">
        <xsd:annotation>
          <xsd:documentation xml:lang="en">
            Defines the Canvas sections for a single ClientSidePage.
          </xsd:documentation>
        </xsd:annotation>

        <xsd:complexType>
          <xsd:sequence>
            <xsd:element name="Section" type="pnp:CanvasSection" minOccurs="0" maxOccurs="unbounded">
              <xsd:annotation>
                <xsd:documentation xml:lang="en">
                  Defines a Canvas section for a single ClientSidePage.
                </xsd:documentation>
              </xsd:annotation>
            </xsd:element> 
          </xsd:sequence>
        </xsd:complexType>
        
      </xsd:element>

    </xsd:sequence>

    <xsd:attribute name="PageName" type="xsd:string" use="required">
      <xsd:annotation>
        <xsd:appinfo>Added with schema version 201705</xsd:appinfo>
        <xsd:documentation xml:lang="en">
          Defines the page name for a single ClientSidePage.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>

    <xsd:attribute name="PromoteAsNewsArticle" type="xsd:boolean" use="optional">
      <xsd:annotation>
        <xsd:appinfo>Added with schema version 201705</xsd:appinfo>
        <xsd:documentation xml:lang="en">
          Declares to promote the page as a news article.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>

    <xsd:attribute name="Overwrite" type="xsd:boolean" use="optional">
      <xsd:annotation>
        <xsd:appinfo>Added with schema version 201705</xsd:appinfo>
        <xsd:documentation xml:lang="en">
          Can the page be overwritten if it exists.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>

  </xsd:complexType>

  <xsd:complexType name="CanvasSection">
    <xsd:annotation>
      <xsd:documentation xml:lang="en">
        A Canvas Section for a Client-side Page.
      </xsd:documentation>
    </xsd:annotation>
    
    <xsd:sequence>
      <xsd:element name="Controls" minOccurs="0" maxOccurs="1">
        <xsd:annotation>
          <xsd:documentation xml:lang="en">
            A collection of Canvas Controls for a Client-side Page.
          </xsd:documentation>
        </xsd:annotation>

        <xsd:complexType>
          <xsd:sequence>
            <xsd:element name="CanvasControl" type="pnp:CanvasControl" minOccurs="0" maxOccurs="unbounded">
              <xsd:annotation>
                <xsd:documentation xml:lang="en">
                  A single Canvas Control for a Client-side Page.
                </xsd:documentation>
              </xsd:annotation>
            </xsd:element>
          </xsd:sequence>
        </xsd:complexType>
      </xsd:element>
    </xsd:sequence>

    <xsd:attribute name="Order" type="xsd:int" use="optional">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          The order of the Canvas Section for a Client-side Page.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>
    
    <xsd:attribute name="Type">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          The type of the Canvas Section for a Client-side Page.
        </xsd:documentation>
      </xsd:annotation>

      <xsd:simpleType>
        <xsd:restriction base="xsd:string">
          <xsd:enumeration value="OneColumn">
            <xsd:annotation>
              <xsd:documentation xml:lang="en">
                One column
              </xsd:documentation>
            </xsd:annotation>
          </xsd:enumeration>
          <xsd:enumeration value="OneColumnFullWidth">
            <xsd:annotation>
              <xsd:documentation xml:lang="en">
                One column, full browser width. This one only works for communication sites in combination with image or hero webparts
              </xsd:documentation>
            </xsd:annotation>
          </xsd:enumeration>
          <xsd:enumeration value="TwoColumn">
            <xsd:annotation>
              <xsd:documentation xml:lang="en">
                Two columns of the same size
              </xsd:documentation>
            </xsd:annotation>
          </xsd:enumeration>
          <xsd:enumeration value="ThreeColumn">
            <xsd:annotation>
              <xsd:documentation xml:lang="en">
                Three columns of the same size
              </xsd:documentation>
            </xsd:annotation>
          </xsd:enumeration>
          <xsd:enumeration value="TwoColumnLeft">
            <xsd:annotation>
              <xsd:documentation xml:lang="en">
                Two columns, left one is 2/3, right one 1/3
              </xsd:documentation>
            </xsd:annotation>
          </xsd:enumeration>
          <xsd:enumeration value="TwoColumnRight">
            <xsd:annotation>
              <xsd:documentation xml:lang="en">
                Two columns, left one is 1/3, right one 2/3
              </xsd:documentation>
            </xsd:annotation>
          </xsd:enumeration>
        </xsd:restriction>
      </xsd:simpleType>
    </xsd:attribute>
    
  </xsd:complexType>

  <xsd:complexType name="CanvasControl">
    <xsd:annotation>
      <xsd:documentation xml:lang="en">
        Defines a Canvas Control for a Client-side Page.
      </xsd:documentation>
    </xsd:annotation>

    <xsd:sequence>
      <xsd:element name="CanvasControlProperties" minOccurs="0" maxOccurs="1">
        <xsd:annotation>
          <xsd:documentation xml:lang="en">
            Custom properties for the client-side web part control.
          </xsd:documentation>
        </xsd:annotation>

        <xsd:complexType>
          <xsd:sequence>
            <xsd:element name="CanvasControlProperty" type="pnp:StringDictionaryItem" minOccurs="0" maxOccurs="unbounded">
              <xsd:annotation>
                <xsd:documentation xml:lang="en">
                  A single property of a client-side web part control.
                </xsd:documentation>
              </xsd:annotation>
            </xsd:element>
          </xsd:sequence>
        </xsd:complexType>
      </xsd:element>
    </xsd:sequence>

    <xsd:attribute name="WebPartType" use="required">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          The Type of Client-side Web Part.
        </xsd:documentation>
      </xsd:annotation>

      <xsd:simpleType>
        <xsd:restriction base="xsd:string">
          <xsd:enumeration value="Custom" />
          <xsd:enumeration value="Text" />
          <xsd:enumeration value="ContentRollup" />
          <xsd:enumeration value="BingMap" />
          <xsd:enumeration value="ContentEmbed" />
          <xsd:enumeration value="DocumentEmbed" />
          <xsd:enumeration value="Image" />
          <xsd:enumeration value="ImageGallery" />
          <xsd:enumeration value="LinkPreview" />
          <xsd:enumeration value="NewsFeed" />
          <xsd:enumeration value="NewsReel" />
          <xsd:enumeration value="PowerBIReportEmbed" />
          <xsd:enumeration value="QuickChart" />
          <xsd:enumeration value="SiteActivity" />
          <xsd:enumeration value="VideoEmbed" />
          <xsd:enumeration value="YammerEmbed" />
          <xsd:enumeration value="Events" />
          <xsd:enumeration value="GroupCalendar" />
          <xsd:enumeration value="Hero" />
          <xsd:enumeration value="List" />
          <xsd:enumeration value="PageTitle" />
          <xsd:enumeration value="People" />
          <xsd:enumeration value="QuickLinks" />
        </xsd:restriction>
      </xsd:simpleType>
      
    </xsd:attribute>

    <xsd:attribute name="CustomWebPartName" type="xsd:string" use="optional">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          The Name of the client-side web part if the WebPartType attribute has a value of "Custom".
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>

    <xsd:attribute name="JsonControlData" type="xsd:string" use="optional">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          The JSON Control Data for Canvas Control of a Client-side Page.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>

    <xsd:attribute name="ControlId" type="pnp:GUID" use="optional">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          The Instance Id for Canvas Control of a Client-side Page.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>

    <xsd:attribute name="Order" type="xsd:int" use="optional" default="0">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          The order of the Canvas Control for a Client-side Page.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>

    <xsd:attribute name="Column" type="xsd:int" use="optional" default="0">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          The Column of the Section in which the Canvas Control will be inserted. Optional, default 0.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>

  </xsd:complexType>

  <xsd:complexType name="CanvasColumn">
    <xsd:annotation>
      <xsd:documentation xml:lang="en">
        Defines a Canvas Section for a Client-side Page.
      </xsd:documentation>
    </xsd:annotation>

    <xsd:sequence>
      <xsd:element name="Controls" minOccurs="0" maxOccurs="1">
        <xsd:annotation>
          <xsd:documentation xml:lang="en">
            A collection of Canvas Controls for a Client-side Page.
          </xsd:documentation>
        </xsd:annotation>

        <xsd:complexType>
          <xsd:sequence>
            <xsd:element name="CanvasControl" type="pnp:CanvasControl" minOccurs="0" maxOccurs="unbounded">
              <xsd:annotation>
                <xsd:documentation xml:lang="en">
                  A single Canvas Control for a Client-side Page.
                </xsd:documentation>
              </xsd:annotation>
            </xsd:element>
          </xsd:sequence>
        </xsd:complexType>
      </xsd:element>
    </xsd:sequence>

    <xsd:attribute name="Order" type="xsd:int" use="optional">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          The order of the Canvas section for a Client-side Page.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>

    <xsd:attribute name="ColumnFactor" type="xsd:int" use="optional">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          The column Factor for Canvas column of a Client-side Page.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>

  </xsd:complexType>

  <xsd:complexType name="FileProperties">
    <xsd:annotation>
      <xsd:documentation xml:lang="en">
        A collection of File Properties.
      </xsd:documentation>
    </xsd:annotation>
    <xsd:sequence>
      <xsd:element name="Property" type="pnp:StringDictionaryItem"
                    minOccurs="1" maxOccurs="unbounded" />
    </xsd:sequence>
  </xsd:complexType>

  <xsd:complexType name="File">
    <xsd:annotation>
      <xsd:documentation xml:lang="en">
        Defines a File element, to describe a file that will be provisioned into the target Site.
      </xsd:documentation>
    </xsd:annotation>

    <xsd:all>
      <xsd:element name="Properties" type="pnp:FileProperties" minOccurs="0" maxOccurs="1">
        <xsd:annotation>
          <xsd:documentation xml:lang="en">
            The File Properties, optional collection of elements.
          </xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="WebParts" minOccurs="0">
        <xsd:annotation>
          <xsd:documentation xml:lang="en">
            The webparts to add to the page, optional collection of elements.
          </xsd:documentation>
        </xsd:annotation>
        <xsd:complexType>
          <xsd:sequence>
            <xsd:element name="WebPart" type="pnp:WebPartPageWebPart"
                         minOccurs="1" maxOccurs="unbounded" />
          </xsd:sequence>
        </xsd:complexType>
      </xsd:element>
      <xsd:element name="Security" type="pnp:ObjectSecurity" minOccurs="0" maxOccurs="1" />
    </xsd:all>

    <xsd:attribute name="Src" type="xsd:string" use="required">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          The Src of the File, required attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>

    <xsd:attribute name="Folder" type="xsd:string" use="required">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          The TargetFolder of the File, required attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>

    <xsd:attribute name="Overwrite" type="xsd:boolean" use="optional" default="false">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          The Overwrite flag for the File, optional attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>

    <xsd:attribute name="Level" type="pnp:FileLevel" use="optional">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          The Level status for the File, optional attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>
    
    <xsd:attribute name="TargetFileName" type="pnp:ReplaceableString" use="optional">
      <xsd:annotation>
        <xsd:appinfo>Added with schema version 201705</xsd:appinfo>
        <xsd:documentation xml:lang="en">
          The Target file name for the File, optional attribute. If missing, the original file name will be used.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>

  </xsd:complexType>

  <xsd:complexType name="Directory">
    <xsd:annotation>
      <xsd:documentation xml:lang="en">
        Defines a Directory element, to describe a folder in the current repository that will be used to upload files into the target Site.
      </xsd:documentation>
    </xsd:annotation>

    <xsd:all>
      <xsd:element name="Security" type="pnp:ObjectSecurity" minOccurs="0" maxOccurs="1" />
    </xsd:all>

    <xsd:attribute name="Src" type="pnp:ReplaceableString" use="required">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          The Src of the Directory, required attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>

    <xsd:attribute name="Folder" type="pnp:ReplaceableString" use="required">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          The TargetFolder of the Directory, required attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>

    <xsd:attribute name="Overwrite" type="xsd:boolean" use="optional" default="false">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          The Overwrite flag for the File items in the Directory, optional attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>

    <xsd:attribute name="Level" type="pnp:FileLevel" use="optional">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          The Level status for the File, optional attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>

    <xsd:attribute name="Recursive" type="xsd:boolean" use="optional" default="false">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          Defines whether to recursively browse through all the child folders of the Directory, optional attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>

    <xsd:attribute name="IncludedExtensions" type="xsd:string" use="optional" default="*.*">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          The file Extensions (lower case) to include while uploading the Directory, optional attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>

    <xsd:attribute name="ExcludedExtensions" type="xsd:string" use="optional" default="">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          The file Extensions (lower case) to exclude while uploading the Directory, optional attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>

    <xsd:attribute name="MetadataMappingFile" type="pnp:ReplaceableString" use="optional" default="">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          The file path of JSON mapping file with metadata for files to upload in the Directory, optional attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>

  </xsd:complexType>

  <xsd:complexType name="Page">
    <xsd:annotation>
      <xsd:documentation xml:lang="en">
        Defines a Page element, to describe a page that will be provisioned into the target Site. Because of the Layout attribute, the assumption is made that you're referring/creating a WikiPage.
      </xsd:documentation>
    </xsd:annotation>

    <xsd:all>
      <xsd:element name="WebParts" minOccurs="0">
        <xsd:annotation>
          <xsd:documentation xml:lang="en">
            The webparts to add to the page, optional collection of elements.
          </xsd:documentation>
        </xsd:annotation>
        <xsd:complexType>
          <xsd:sequence>
            <xsd:element name="WebPart" type="pnp:WikiPageWebPart"
                         minOccurs="1" maxOccurs="unbounded" />
          </xsd:sequence>
        </xsd:complexType>
      </xsd:element>
      <xsd:element name="Fields" minOccurs="0" maxOccurs="1">
        <xsd:annotation>
          <xsd:documentation xml:lang="en">
            The Fields to setup for the Page, optional collection of elements.
          </xsd:documentation>
        </xsd:annotation>
        <xsd:complexType>
          <xsd:sequence>
            <xsd:element name="Field" type="pnp:BaseFieldValue"
                         minOccurs="1" maxOccurs="unbounded" />
          </xsd:sequence>
        </xsd:complexType>
      </xsd:element>
      <xsd:element name="Security" type="pnp:ObjectSecurity" minOccurs="0" maxOccurs="1" />
    </xsd:all>

    <xsd:attribute name="Url" type="xsd:string" use="required">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          The server relative url of the page, supports tokens, required attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>

    <xsd:attribute name="Overwrite" type="xsd:boolean" use="optional" default="false">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          If set, overwrites an existing page in the case of a wikipage, optional attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>

    <xsd:attribute name="Layout" type="pnp:WikiPageLayout" use="required">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          Defines the layout of the wikipage, required attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>
  </xsd:complexType>

  <xsd:complexType name="WikiPageWebPart">
    <xsd:annotation>
      <xsd:documentation xml:lang="en">
        Defines a WebPart to be added to a WikiPage.
      </xsd:documentation>
    </xsd:annotation>

    <xsd:all>
      <xsd:element name="Contents" minOccurs="1" maxOccurs="1">
        <xsd:annotation>
          <xsd:documentation xml:lang="en">
            Defines the WebPart XML, required element.
          </xsd:documentation>
        </xsd:annotation>
        <xsd:complexType>
          <xsd:sequence>
            <xsd:any processContents="lax" namespace="##any" minOccurs="0" />
          </xsd:sequence>
        </xsd:complexType>
      </xsd:element>
    </xsd:all>
    <xsd:attribute name="Title" type="xsd:string" use="required">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          Defines the title of the WebPart, required attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>
    <xsd:attribute name="Row" type="xsd:int" use="required">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          Defines the row to add the WebPart to, required attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>
    <xsd:attribute name="Column" type="xsd:int" use="required">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          Defines the column to add the WebPart to, required attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>
  </xsd:complexType>

  <xsd:complexType name="WebPartPageWebPart">
    <xsd:annotation>
      <xsd:documentation xml:lang="en">
        Defines a webpart to be added to a WebPart Page.
      </xsd:documentation>
    </xsd:annotation>
    <xsd:all>
      <xsd:element name="Contents" minOccurs="1" maxOccurs="1">
        <xsd:annotation>
          <xsd:documentation xml:lang="en">
            Defines the WebPart XML, required element.
          </xsd:documentation>
        </xsd:annotation>

        <xsd:complexType>
          <xsd:sequence>
            <xsd:any processContents="lax" namespace="##any" minOccurs="0" />
          </xsd:sequence>
        </xsd:complexType>

      </xsd:element>
    </xsd:all>
    <xsd:attribute name="Title" type="xsd:string" use="required">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          Defines the title of the WebPart, required attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>
    <xsd:attribute name="Zone" type="xsd:string" use="required">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          Defines the zone of a WebPart Page to add the webpart to, required attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>
    <xsd:attribute name="Order" type="xsd:int" use="required">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          Defines the index of the WebPart in the zone, required attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>
  </xsd:complexType>

  <xsd:complexType name="ComposedLook">
    <xsd:annotation>
      <xsd:documentation xml:lang="en">
        Defines a ComposedLook element.
      </xsd:documentation>
    </xsd:annotation>

    <xsd:attribute name="Name" type="xsd:string" use="required">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          The Name of the ComposedLook, required attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>

    <xsd:attribute name="ColorFile" type="xsd:string" use="required">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          The ColorFile of the ComposedLook, required attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>

    <xsd:attribute name="FontFile" type="xsd:string" use="required">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          The FontFile of the ComposedLook, required attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>

    <xsd:attribute name="BackgroundFile" type="xsd:string" use="required">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          The BackgroundFile of the ComposedLook, optional attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>

    <xsd:attribute name="Version" type="xsd:int" use="optional">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          The Version of the ComposedLook, optional attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>

  </xsd:complexType>

  <xsd:complexType name="Workflows">
    <xsd:annotation>
      <xsd:documentation xml:lang="en">
        Defines the Workflows to provision.
      </xsd:documentation>
    </xsd:annotation>

    <xsd:sequence>

      <xsd:element name="WorkflowDefinitions">
        <xsd:complexType>
          <xsd:annotation>
            <xsd:documentation xml:lang="en">
              Defines the Workflows Definitions to provision.
            </xsd:documentation>
          </xsd:annotation>

          <xsd:sequence>
            <xsd:element name="WorkflowDefinition" minOccurs="0" maxOccurs="unbounded">
              <xsd:complexType>
                <xsd:annotation>
                  <xsd:documentation xml:lang="en">
                    Defines a Workflow Definition to provision, optional element.
                  </xsd:documentation>
                </xsd:annotation>

                <xsd:sequence>
                  <xsd:element name="Properties" minOccurs="0">
                    <xsd:complexType>
                      <xsd:annotation>
                        <xsd:documentation xml:lang="en">
                          Defines the Properties of the Workflows to provision, optional collection of elements.
                        </xsd:documentation>
                      </xsd:annotation>

                      <xsd:sequence>
                        <xsd:element name="Property" type="pnp:StringDictionaryItem"
                                      minOccurs="1" maxOccurs="unbounded">
                          <xsd:annotation>
                            <xsd:documentation xml:lang="en">
                              Defines a Property for the Workflows to provision.
                            </xsd:documentation>
                          </xsd:annotation>
                        </xsd:element>
                      </xsd:sequence>
                    </xsd:complexType>
                  </xsd:element>

                  <xsd:element name="FormField" minOccurs="0">
                    <xsd:complexType>
                      <xsd:annotation>
                        <xsd:documentation xml:lang="en">
                          Defines the FormField XML of the Workflow to provision, optional element.
                        </xsd:documentation>
                      </xsd:annotation>

                      <xsd:sequence>
                        <xsd:any minOccurs="0" maxOccurs="1" processContents="skip" />
                      </xsd:sequence>
                    </xsd:complexType>
                  </xsd:element>

                </xsd:sequence>

                <xsd:attribute name="Id" type="pnp:GUID" use="required">
                  <xsd:annotation>
                    <xsd:documentation xml:lang="en">
                      Defines the ID of the Workflow Definition for the current Subscription, required attribute.
                    </xsd:documentation>
                  </xsd:annotation>
                </xsd:attribute>

                <xsd:attribute name="AssociationUrl" type="xsd:string" use="optional">
                  <xsd:annotation>
                    <xsd:documentation xml:lang="en">
                      Defines the URL of the Workflow Association page, optional attribute.
                    </xsd:documentation>
                  </xsd:annotation>
                </xsd:attribute>

                <xsd:attribute name="Description" type="xsd:string" use="optional">
                  <xsd:annotation>
                    <xsd:documentation xml:lang="en">
                      The Description of the Workflow, optional attribute.
                    </xsd:documentation>
                  </xsd:annotation>
                </xsd:attribute>

                <xsd:attribute name="DisplayName" type="xsd:string" use="required">
                  <xsd:annotation>
                    <xsd:documentation xml:lang="en">
                      The Display Name of the Workflow, required attribute.
                    </xsd:documentation>
                  </xsd:annotation>
                </xsd:attribute>

                <xsd:attribute name="DraftVersion" type="xsd:string" use="optional">
                  <xsd:annotation>
                    <xsd:documentation xml:lang="en">
                      Defines the DraftVersion of the Workflow, optional attribute.
                    </xsd:documentation>
                  </xsd:annotation>
                </xsd:attribute>

                <xsd:attribute name="InitiationUrl" type="xsd:string" use="optional">
                  <xsd:annotation>
                    <xsd:documentation xml:lang="en">
                      Defines the URL of the Workflow Initiation page, optional attribute.
                    </xsd:documentation>
                  </xsd:annotation>
                </xsd:attribute>

                <xsd:attribute name="Published" type="xsd:boolean" use="optional">
                  <xsd:annotation>
                    <xsd:documentation xml:lang="en">
                      Defines if the Workflow is Published, optional attribute.
                    </xsd:documentation>
                  </xsd:annotation>
                </xsd:attribute>

                <xsd:attribute name="RequiresAssociationForm" type="xsd:boolean" use="optional">
                  <xsd:annotation>
                    <xsd:documentation xml:lang="en">
                      Defines if the Workflow requires the Association Form, optional attribute.
                    </xsd:documentation>
                  </xsd:annotation>
                </xsd:attribute>

                <xsd:attribute name="RequiresInitiationForm" type="xsd:boolean" use="optional">
                  <xsd:annotation>
                    <xsd:documentation xml:lang="en">
                      Defines if the Workflow requires the Initiation Form, optional attribute.
                    </xsd:documentation>
                  </xsd:annotation>
                </xsd:attribute>

                <xsd:attribute name="RestrictToScope" type="pnp:ReplaceableString" use="optional">
                  <xsd:annotation>
                    <xsd:documentation xml:lang="en">
                      Defines the Scope Restriction for the Workflow, optional attribute.
                    </xsd:documentation>
                  </xsd:annotation>
                </xsd:attribute>

                <xsd:attribute name="RestrictToType" use="optional">
                  <xsd:annotation>
                    <xsd:documentation xml:lang="en">
                      Defines the Type of Scope Restriction for the Workflow, optional attribute.
                    </xsd:documentation>
                  </xsd:annotation>
                  <xsd:simpleType>
                    <xsd:restriction base="xsd:string">
                      <xsd:enumeration value="Universal" />
                      <xsd:enumeration value="List" />
                      <xsd:enumeration value="Site" />
                    </xsd:restriction>
                  </xsd:simpleType>
                </xsd:attribute>

                <xsd:attribute name="XamlPath" type="xsd:string" use="required">
                  <xsd:annotation>
                    <xsd:documentation xml:lang="en">
                      Defines the XAML of the Workflow to provision, required attribute.
                    </xsd:documentation>
                  </xsd:annotation>
                </xsd:attribute>

              </xsd:complexType>
            </xsd:element>
          </xsd:sequence>
        </xsd:complexType>
      </xsd:element>

      <xsd:element name="WorkflowSubscriptions">
        <xsd:complexType>
          <xsd:annotation>
            <xsd:documentation xml:lang="en">
              Defines the Workflows Subscriptions to provision.
            </xsd:documentation>
          </xsd:annotation>

          <xsd:sequence>
            <xsd:element name="WorkflowSubscription" minOccurs="0" maxOccurs="unbounded">
              <xsd:complexType>
                <xsd:annotation>
                  <xsd:documentation xml:lang="en">
                    Defines a Workflow Subscription to provision, optional collection of elements.
                  </xsd:documentation>
                </xsd:annotation>

                <xsd:sequence>
                  <xsd:element name="PropertyDefinitions" minOccurs="0">
                    <xsd:complexType>
                      <xsd:annotation>
                        <xsd:documentation xml:lang="en">
                          Defines the Property Definitions of the Workflows to provision, optional collection of elements.
                        </xsd:documentation>
                      </xsd:annotation>

                      <xsd:sequence>
                        <xsd:element name="PropertyDefinition" type="pnp:StringDictionaryItem"
                                      minOccurs="1" maxOccurs="unbounded">
                          <xsd:annotation>
                            <xsd:documentation xml:lang="en">
                              Defines the Property Definition of the Workflows to provision.
                            </xsd:documentation>
                          </xsd:annotation>
                        </xsd:element>
                      </xsd:sequence>
                    </xsd:complexType>
                  </xsd:element>

                </xsd:sequence>

                <xsd:attribute name="DefinitionId" type="pnp:GUID" use="required">
                  <xsd:annotation>
                    <xsd:documentation xml:lang="en">
                      Defines the ID of the Workflow Definition for the current Subscription, required attribute.
                    </xsd:documentation>
                  </xsd:annotation>
                </xsd:attribute>

                <xsd:attribute name="ListId" type="pnp:ReplaceableString" use="optional">
                  <xsd:annotation>
                    <xsd:documentation xml:lang="en">
                      Defines the ID of the target list/library for the current Subscription,
                      optional attribute and if it is missing, the workflow subscription will
                      be at Site level, optional attribute.
                    </xsd:documentation>
                  </xsd:annotation>
                </xsd:attribute>

                <xsd:attribute name="Enabled" type="xsd:boolean" use="required">
                  <xsd:annotation>
                    <xsd:documentation xml:lang="en">
                      Defines if the Workflow Definition is enabled for the current Subscription, required attribute.
                    </xsd:documentation>
                  </xsd:annotation>
                </xsd:attribute>

                <xsd:attribute name="EventSourceId" type="pnp:ReplaceableString" use="optional">
                  <xsd:annotation>
                    <xsd:documentation xml:lang="en">
                      Defines the ID of the Event Source for the current Subscription, optional attribute.
                    </xsd:documentation>
                  </xsd:annotation>
                </xsd:attribute>

                <xsd:attribute name="WorkflowStartEvent" type="xsd:boolean" use="required">
                  <xsd:annotation>
                    <xsd:documentation xml:lang="en">
                      Defines if the Workflow will start manually, required attribute.
                    </xsd:documentation>
                  </xsd:annotation>
                </xsd:attribute>

                <xsd:attribute name="ItemAddedEvent" type="xsd:boolean" use="required">
                  <xsd:annotation>
                    <xsd:documentation xml:lang="en">
                      Defines if the Workflow will start on item added, required attribute.
                    </xsd:documentation>
                  </xsd:annotation>
                </xsd:attribute>

                <xsd:attribute name="ItemUpdatedEvent" type="xsd:boolean" use="required">
                  <xsd:annotation>
                    <xsd:documentation xml:lang="en">
                      Defines if the Workflow will start on item updated, required attribute.
                    </xsd:documentation>
                  </xsd:annotation>
                </xsd:attribute>

                <xsd:attribute name="ManualStartBypassesActivationLimit" type="xsd:boolean" use="optional">
                  <xsd:annotation>
                    <xsd:documentation xml:lang="en">
                      Defines if the Workflow can be manually started bypassing the activation limit, optional attribute.
                    </xsd:documentation>
                  </xsd:annotation>
                </xsd:attribute>

                <xsd:attribute name="Name" type="xsd:string" use="required">
                  <xsd:annotation>
                    <xsd:documentation xml:lang="en">
                      Defines the Name of the Workflow Subscription, required attribute.
                    </xsd:documentation>
                  </xsd:annotation>
                </xsd:attribute>

                <xsd:attribute name="ParentContentTypeId" type="xsd:string" use="optional">
                  <xsd:annotation>
                    <xsd:documentation xml:lang="en">
                      Defines the Parent ContentType Id of the Workflow Subscription, optional attribute.
                    </xsd:documentation>
                  </xsd:annotation>
                </xsd:attribute>

                <xsd:attribute name="StatusFieldName" type="xsd:string" use="required">
                  <xsd:annotation>
                    <xsd:documentation xml:lang="en">
                      Defines the Status Field Name of the Workflow Subscription, required attribute.
                    </xsd:documentation>
                  </xsd:annotation>
                </xsd:attribute>

              </xsd:complexType>
            </xsd:element>
          </xsd:sequence>
        </xsd:complexType>
      </xsd:element>

    </xsd:sequence>

  </xsd:complexType>

  <xsd:complexType name="AddIns">
    <xsd:annotation>
      <xsd:documentation xml:lang="en">
        Defines the SharePoint Add-ins to provision, collection of elements.
      </xsd:documentation>
    </xsd:annotation>

    <xsd:sequence>
      <xsd:element name="Addin" minOccurs="0" maxOccurs="unbounded">
        <xsd:complexType>

          <xsd:attribute name="PackagePath" type="xsd:string" use="required">
            <xsd:annotation>
              <xsd:documentation xml:lang="en">
                Defines the .app file of the SharePoint Add-in to provision, required attribute.
              </xsd:documentation>
            </xsd:annotation>
          </xsd:attribute>

          <xsd:attribute name="Source" use="required">
            <xsd:annotation>
              <xsd:documentation xml:lang="en">
                Defines the Source of the SharePoint Add-in to provision, required attribute.
              </xsd:documentation>
            </xsd:annotation>
            <xsd:simpleType>
              <xsd:restriction base="xsd:string">
                <xsd:enumeration value="CorporateCatalog" />
                <xsd:enumeration value="DeveloperSite" />
                <xsd:enumeration value="InvalidSource" />
                <xsd:enumeration value="Marketplace" />
                <xsd:enumeration value="ObjectModel" />
                <xsd:enumeration value="RemoteObjectModel" />
              </xsd:restriction>
            </xsd:simpleType>
          </xsd:attribute>

        </xsd:complexType>
      </xsd:element>
    </xsd:sequence>

  </xsd:complexType>

  <xsd:complexType name="Publishing">
    <xsd:annotation>
      <xsd:documentation xml:lang="en">
        Defines the Publishing configuration to provision.
      </xsd:documentation>
    </xsd:annotation>

    <xsd:sequence>

      <xsd:element name="DesignPackage" minOccurs="0" maxOccurs="1">
        <xsd:annotation>
          <xsd:documentation xml:lang="en">
            Defines a Design Package to import into the current Publishing site, optional element.
          </xsd:documentation>
        </xsd:annotation>

        <xsd:complexType>

          <xsd:attribute name="DesignPackagePath" type="xsd:string" use="required">
            <xsd:annotation>
              <xsd:documentation xml:lang="en">
                Defines the path of the Design Package to import into the current Publishing site, required attribute.
              </xsd:documentation>
            </xsd:annotation>
          </xsd:attribute>

          <xsd:attribute name="MajorVersion" type="xsd:int" use="optional">
            <xsd:annotation>
              <xsd:documentation xml:lang="en">
                The Major Version of the Design Package to import into the current Publishing site, optional attribute.
              </xsd:documentation>
            </xsd:annotation>
          </xsd:attribute>

          <xsd:attribute name="MinorVersion" type="xsd:int" use="optional">
            <xsd:annotation>
              <xsd:documentation xml:lang="en">
                The Minor Version of the Design Package to import into the current Publishing site, optional attribute.
              </xsd:documentation>
            </xsd:annotation>
          </xsd:attribute>

          <xsd:attribute name="PackageGuid" type="pnp:GUID" use="optional">
            <xsd:annotation>
              <xsd:documentation xml:lang="en">
                The ID of the Design Package to import into the current Publishing site, optional attribute.
              </xsd:documentation>
            </xsd:annotation>
          </xsd:attribute>

          <xsd:attribute name="PackageName" type="xsd:string" use="required">
            <xsd:annotation>
              <xsd:documentation xml:lang="en">
                The Name of the Design Package to import into the current Publishing site, required attribute.
              </xsd:documentation>
            </xsd:annotation>
          </xsd:attribute>

        </xsd:complexType>

      </xsd:element>

      <xsd:element name="AvailableWebTemplates" minOccurs="0" maxOccurs="1">
        <xsd:annotation>
          <xsd:documentation xml:lang="en">
            Defines the Available Web Templates for the current Publishing site, optional collection of elements.
          </xsd:documentation>
        </xsd:annotation>
        <xsd:complexType>
          <xsd:sequence>
            <xsd:element name="WebTemplate" minOccurs="0" maxOccurs="unbounded">
              <xsd:annotation>
                <xsd:documentation xml:lang="en">
                  Defines an available Web Template for the current Publishing site.
                </xsd:documentation>
              </xsd:annotation>
              <xsd:complexType>
                <xsd:attribute name="LanguageCode" type="xsd:int" use="optional">
                  <xsd:annotation>
                    <xsd:documentation xml:lang="en">
                      The Language Code for the Web Template, optional attribute.
                    </xsd:documentation>
                  </xsd:annotation>
                </xsd:attribute>
                <xsd:attribute name="TemplateName" type="xsd:string" use="required">
                  <xsd:annotation>
                    <xsd:documentation xml:lang="en">
                      The Name of the Web Template, required attribute.
                    </xsd:documentation>
                  </xsd:annotation>
                </xsd:attribute>
              </xsd:complexType>
            </xsd:element>
          </xsd:sequence>
        </xsd:complexType>
      </xsd:element>

      <xsd:element name="PageLayouts" minOccurs="0" maxOccurs="1">
        <xsd:annotation>
          <xsd:documentation xml:lang="en">
            Defines the Available Page Layouts for the current Publishing site, optional collection of elements.
          </xsd:documentation>
        </xsd:annotation>

        <xsd:complexType>

          <xsd:sequence>
            <xsd:element name="PageLayout" minOccurs="0" maxOccurs="unbounded">
              <xsd:annotation>
                <xsd:documentation xml:lang="en">
                  Defines an available Page Layout for the current Publishing site.
                </xsd:documentation>
              </xsd:annotation>

              <xsd:complexType>
                <xsd:attribute name="Path" type="xsd:string" use="required">
                  <xsd:annotation>
                    <xsd:documentation xml:lang="en">
                      Defines the path of the Page Layout for the current Publishing site, required attribute.
                    </xsd:documentation>
                  </xsd:annotation>
                </xsd:attribute>
              </xsd:complexType>

            </xsd:element>
          </xsd:sequence>

          <xsd:attribute name="Default" type="xsd:string" use="optional">
            <xsd:annotation>
              <xsd:documentation xml:lang="en">
                Defines the URL of the Default Page Layout for the current Publishing site, if any. Optional attribute.
              </xsd:documentation>
            </xsd:annotation>
          </xsd:attribute>

        </xsd:complexType>
      </xsd:element>

      <xsd:element name="ImageRenditions" minOccurs="0" maxOccurs="1">
        <xsd:annotation>
          <xsd:appinfo>Added with schema version 201705</xsd:appinfo>
          <xsd:documentation xml:lang="en">
            Defines the Image Renditions for the current Publishing site, optional collection of elements.
          </xsd:documentation>
        </xsd:annotation>

        <xsd:complexType>
          <xsd:sequence>
            <xsd:element name="ImageRendition" minOccurs="0" maxOccurs="unbounded">
              <xsd:annotation>
                <xsd:documentation xml:lang="en">
                  Defines an available Image Rendition for the current Publishing site.
                </xsd:documentation>
              </xsd:annotation>

              <xsd:complexType>
                <xsd:attribute name="Name" type="pnp:ReplaceableString" use="required">
                  <xsd:annotation>
                    <xsd:documentation xml:lang="en">
                      Defines the name of the Image Rendition for the current Publishing site, required attribute.
                    </xsd:documentation>
                  </xsd:annotation>
                </xsd:attribute>
                <xsd:attribute name="Width" type="pnp:ReplaceableInt" use="required">
                  <xsd:annotation>
                    <xsd:documentation xml:lang="en">
                      Defines the width of the Image Rendition for the current Publishing site, required attribute.
                    </xsd:documentation>
                  </xsd:annotation>
                </xsd:attribute>
                <xsd:attribute name="Height" type="pnp:ReplaceableInt" use="required">
                  <xsd:annotation>
                    <xsd:documentation xml:lang="en">
                      Defines the height of the Image Rendition for the current Publishing site, required attribute.
                    </xsd:documentation>
                  </xsd:annotation>
                </xsd:attribute>
              </xsd:complexType>

            </xsd:element>
          </xsd:sequence>
        </xsd:complexType>
        
      </xsd:element>

    </xsd:sequence>

    <xsd:attribute name="AutoCheckRequirements" use="required">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          Defines how an engine should behave if the requirements for provisioning publishing capabilities are not satisfied by the target site, required attribute.
        </xsd:documentation>
      </xsd:annotation>
      <xsd:simpleType>
        <xsd:restriction base="xsd:string">
          <xsd:enumeration value="MakeCompliant">
            <xsd:annotation>
              <xsd:documentation xml:lang="en">
                Instructs the engine to make the target site compliant with the requirements.
              </xsd:documentation>
            </xsd:annotation>
          </xsd:enumeration>
          <xsd:enumeration value="SkipIfNotCompliant">
            <xsd:annotation>
              <xsd:documentation xml:lang="en">
                Instructs the engine to skip the Publishing section if the target site is not compliant with the requirements.
              </xsd:documentation>
            </xsd:annotation>
          </xsd:enumeration>
          <xsd:enumeration value="FailIfNotCompliant">
            <xsd:annotation>
              <xsd:documentation xml:lang="en">
                Instructs the engine to throw an exception/failure if the target site is not compliant with the requirements.
              </xsd:documentation>
            </xsd:annotation>
          </xsd:enumeration>
        </xsd:restriction>
      </xsd:simpleType>
    </xsd:attribute>

  </xsd:complexType>

  <xsd:complexType name="Provider">
    <xsd:annotation>
      <xsd:documentation xml:lang="en">
        Defines an Extensibility Provider.
      </xsd:documentation>
    </xsd:annotation>

    <xsd:sequence>
      <xsd:element name="Configuration" minOccurs="0">
        <xsd:annotation>
          <xsd:documentation xml:lang="en">
            Defines an optional configuration section for the Extensibility Provider. The configuration section can be any XML.
          </xsd:documentation>
        </xsd:annotation>

        <xsd:complexType mixed="true">
          <xsd:sequence>
            <xsd:any processContents="lax" namespace="##other" minOccurs="0" />
          </xsd:sequence>
        </xsd:complexType>

      </xsd:element>
    </xsd:sequence>

    <xsd:attribute name="Enabled" type="xsd:boolean" use="optional" default="false">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          Defines whether the Extensibility Provider is enabled or not, optional attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>

    <xsd:attribute name="HandlerType" type="xsd:string" use="required">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          The type of the handler. It can be a FQN of a .NET type, the URL of a node.js file, or whatever else, required attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>

  </xsd:complexType>

  <xsd:complexType name="ProvisioningTemplateFile">
    <xsd:annotation>
      <xsd:documentation xml:lang="en">
        An element that references an external file.
      </xsd:documentation>
    </xsd:annotation>
    <xsd:attribute name="File" type="xsd:string" use="required">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          Absolute or relative path to the file, required attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>
    <xsd:attribute name="ID" type="xsd:ID" use="required">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          ID of the referenced template, required attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>
  </xsd:complexType>

  <xsd:complexType name="ProvisioningTemplateReference">
    <xsd:annotation>
      <xsd:documentation xml:lang="en">
        An element that references an external file.
      </xsd:documentation>
    </xsd:annotation>
    <xsd:attribute name="ID" type="xsd:IDREF" use="required">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          ID of the referenced template, required attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>
  </xsd:complexType>

  <xsd:complexType name="Sequence" >
    <xsd:annotation>
      <xsd:documentation xml:lang="en">
        Each Provisioning file is split into a set of Sequence elements.
        The Sequence element groups the artefacts to be provisioned into groups.
        The Sequences must be evaluated by the provisioning engine in the order in which they appear.
      </xsd:documentation>
    </xsd:annotation>
    <xsd:sequence maxOccurs="unbounded">
      <xsd:element name="SiteCollection" type="pnp:SiteCollection" minOccurs="0">
        <xsd:annotation>
          <xsd:documentation xml:lang="en">
            A Site Collection to provision through a Sequence, optional element.
          </xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="Site" type="pnp:Site"  minOccurs="0">
        <xsd:annotation>
          <xsd:documentation xml:lang="en">
            A Site to provision through a Sequence, optional element.
          </xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="TermStore" type="pnp:TermStore"  minOccurs="0">
        <xsd:annotation>
          <xsd:documentation xml:lang="en">
            A Term Store to provision through a Sequence, optional element.
          </xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="Extensions" type="pnp:Extensions" minOccurs="0" maxOccurs="1">
        <xsd:annotation>
          <xsd:documentation xml:lang="en">
            Any Extension to provision through a Sequence, optional element.
          </xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <!-- TODO: add more top level items here-->
    </xsd:sequence>
    <xsd:attribute name="SequenceType" default="Synchronous" use="optional">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          Instructions to the Provisioning engine on how the Containers within the Sequence can be provisioned.
        </xsd:documentation>
      </xsd:annotation>
      <xsd:simpleType>
        <xsd:restriction base="xsd:string">
          <xsd:enumeration value="Synchronous">
            <xsd:annotation>
              <xsd:documentation xml:lang="en">
                The Containers within this Sequence has to be provisioned Synchronous in the order that they appear.
              </xsd:documentation>
            </xsd:annotation>
          </xsd:enumeration>
          <xsd:enumeration value="Asynchronous">
            <xsd:annotation>
              <xsd:documentation xml:lang="en">
                The Containers within this Sequence can be provisioned Asynchronously.
              </xsd:documentation>
            </xsd:annotation>
          </xsd:enumeration>
        </xsd:restriction>
      </xsd:simpleType>
    </xsd:attribute>
    <xsd:attribute name="ID" type="xsd:ID" use="required">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          A unique identifier of the Sequence, required attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>
  </xsd:complexType>

  <xsd:complexType name="SiteCollection">
    <xsd:annotation>
      <xsd:documentation xml:lang="en">
        Defines a SiteCollection that will be created into the target tenant/farm.
      </xsd:documentation>
    </xsd:annotation>
    <xsd:sequence>
      <xsd:element name="Templates" type="pnp:Templates" minOccurs="0">
        <xsd:annotation>
          <xsd:documentation xml:lang="en">
            Templates that can be provisioned together with the Site Collection, optional collection of elements.
          </xsd:documentation>
        </xsd:annotation>
      </xsd:element>
    </xsd:sequence>
    <xsd:attributeGroup ref="pnp:SiteCollectionAttributes"/>
    <xsd:attributeGroup ref="pnp:SiteAttributes"/>
    <xsd:attribute name="Url" type="pnp:ReplaceableString" use="required">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          Absolute Url to the site, required attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>
  </xsd:complexType>

  <xsd:complexType name="Site">
    <xsd:annotation>
      <xsd:documentation xml:lang="en">
        Defines a Site that will be created into a target Site Collection.
      </xsd:documentation>
    </xsd:annotation>
    <xsd:sequence>
      <xsd:element name="Templates" type="pnp:Templates" minOccurs="0">
        <xsd:annotation>
          <xsd:documentation xml:lang="en">
            Templates that can be provisioned together with the Site, optional collection of elements.
          </xsd:documentation>
        </xsd:annotation>
      </xsd:element>
    </xsd:sequence>
    <xsd:attributeGroup ref="pnp:SiteAttributes"/>
    <xsd:attribute name="UseSamePermissionsAsParentSite" type="xsd:boolean" use="optional"/>
    <xsd:attribute name="Url" type="pnp:ReplaceableString" use="required">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          Relative Url to the site, required attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>
  </xsd:complexType>

  <xsd:attributeGroup name="SiteCollectionAttributes">
    <xsd:annotation>
      <xsd:documentation xml:lang="en">
        Common set of attributes for any Site Collection
      </xsd:documentation>
    </xsd:annotation>
    <xsd:attribute name="StorageMaximumLevel" type="pnp:ReplaceableInt" use="optional">
      <xsd:annotation>
        <xsd:documentation>
          Maximum Storage Level, in Megabytes, optional attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>
    <xsd:attribute name="StorageWarningLevel" type="pnp:ReplaceableInt" use="optional">
      <xsd:annotation>
        <xsd:documentation>
          Warning Storage Level, in Megabytes, optional attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>
    <xsd:attribute name="UserCodeMaximumLevel" type="pnp:ReplaceableInt" use="optional">
      <xsd:annotation>
        <xsd:documentation>
          Maximum Resource usage, in points, optional attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>
    <xsd:attribute name="UserCodeWarningLevel" type="pnp:ReplaceableInt" use="optional">
      <xsd:annotation>
        <xsd:documentation>
          Warning Resource usage, in points, optional attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>
    <xsd:attribute name="PrimarySiteCollectionAdmin" type="pnp:ReplaceableString" use="required">
      <xsd:annotation>
        <xsd:documentation>
          ID of the Primary Site Collection Admin, required attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>
    <xsd:attribute name="SecondarySiteCollectionAdmin" type="pnp:ReplaceableString" use="optional">
      <xsd:annotation>
        <xsd:documentation>
          ID of the Secondary Site Collection Admin, optional attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>
  </xsd:attributeGroup>

  <xsd:attributeGroup name="SiteAttributes">
    <xsd:annotation>
      <xsd:documentation xml:lang="en">
        Common set of attributes for any Site.
      </xsd:documentation>
    </xsd:annotation>
    <xsd:attribute name="Title" type="pnp:ReplaceableString"  use="required">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          Title of the site, required attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>
    <xsd:attribute name="SiteTemplate" type="xsd:string"  use="required">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          SiteTemplate of the site, required attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>
    <xsd:attribute name="CustomJSUrl" type="pnp:ReplaceableString" use="optional">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          Custom JavaScript URL, optional attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>
    <xsd:attribute name="QuickLaunchEnabled" type="xsd:boolean" use="optional">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          Is the Quick launch enabled, optional attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>
    <xsd:attribute name="AlternateCssUrl" type="pnp:ReplaceableString" use="optional">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          Alternat CSS URL, optional attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>
    <xsd:attribute name="Language" type="pnp:ReplaceableString" use="optional">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          Language of the target Site, optional attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>
    <xsd:attribute name="AllowDesigner" type="xsd:boolean" use="optional">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          Defines whether SharePoint Designer is allowed or not for the target Site, optional attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>
    <xsd:attribute name="MembersCanShare" type="xsd:boolean" use="optional">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          Defines whether the Site's members can share or not contents, optional attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>
    <xsd:attribute name="TimeZone" type="pnp:ReplaceableInt" use="optional" >
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          Time zone of the site, optional attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>
  </xsd:attributeGroup>

  <xsd:complexType name="TermStore" >
    <xsd:annotation>
      <xsd:documentation xml:lang="en">
        A TermStore to use for provisioning of TermGroups.
      </xsd:documentation>
    </xsd:annotation>
    <xsd:sequence>
      <xsd:element name="TermGroup" type="pnp:TermGroup" minOccurs="0" maxOccurs="unbounded">
        <xsd:annotation>
          <xsd:documentation xml:lang="en">
            The TermGroup element to provision into the target TermStore through, optional collection of elements.
          </xsd:documentation>
        </xsd:annotation>
      </xsd:element>
    </xsd:sequence>
    <xsd:attribute name="Scope" use="required">
      <xsd:annotation>
        <xsd:documentation>
          The scope of the term store, required attribute.
        </xsd:documentation>
      </xsd:annotation>
      <xsd:simpleType>
        <xsd:restriction base="xsd:string">
          <xsd:enumeration value="Default"/>
          <xsd:enumeration value="Current"/>
        </xsd:restriction>
      </xsd:simpleType>
    </xsd:attribute>
  </xsd:complexType>

  <xsd:complexType name="TermGroup">
    <xsd:annotation>
      <xsd:documentation xml:lang="en">
        A TermGroup to use for provisioning of TermSets and Terms.
      </xsd:documentation>
    </xsd:annotation>
    <xsd:complexContent>
      <xsd:extension base="TaxonomyItem">
        <xsd:all>
          <xsd:element name="TermSets">
            <xsd:annotation>
              <xsd:documentation xml:lang="en">
                A collection of Term Set elements.
              </xsd:documentation>
            </xsd:annotation>
            <xsd:complexType>
              <xsd:sequence>
                <xsd:element name="TermSet" type="pnp:TermSet" minOccurs="0" maxOccurs="unbounded">
                  <xsd:annotation>
                    <xsd:documentation xml:lang="en">
                      A Term Set, optional collection of elements.
                    </xsd:documentation>
                  </xsd:annotation>
                </xsd:element>
              </xsd:sequence>
            </xsd:complexType>
          </xsd:element>
          <xsd:element name="Contributors" minOccurs="0">
            <xsd:annotation>
              <xsd:documentation xml:lang="en">
                An optional list of TermGroup Contributors.
              </xsd:documentation>
            </xsd:annotation>
            <xsd:complexType>
              <xsd:sequence>
                <xsd:element name="User" type="pnp:User" minOccurs="0" maxOccurs="unbounded">
                  <xsd:annotation>
                    <xsd:documentation xml:lang="en">
                      A single TermGroup Contributor.
                    </xsd:documentation>
                  </xsd:annotation>
                </xsd:element>
              </xsd:sequence>
            </xsd:complexType>
          </xsd:element>
          <xsd:element name="Managers" minOccurs="0">
            <xsd:annotation>
              <xsd:documentation xml:lang="en">
                An optional list of TermGroup Managers.
              </xsd:documentation>
            </xsd:annotation>
            <xsd:complexType>
              <xsd:sequence>
                <xsd:element name="User" type="pnp:User" minOccurs="0" maxOccurs="unbounded">
                  <xsd:annotation>
                    <xsd:documentation xml:lang="en">
                      A single TermGroup Member.
                    </xsd:documentation>
                  </xsd:annotation>
                </xsd:element>
              </xsd:sequence>
            </xsd:complexType>
          </xsd:element>
        </xsd:all>
        <xsd:attribute name="Description" type="xsd:string" use="optional">
          <xsd:annotation>
            <xsd:documentation xml:lang="en">
              The Description of the TermGroup to use for provisioning of TermSets and Terms, optional attribute.
            </xsd:documentation>
          </xsd:annotation>
        </xsd:attribute>
        <xsd:attribute name="SiteCollectionTermGroup" type="xsd:boolean" use="optional">
          <xsd:annotation>
            <xsd:documentation xml:lang="en">
              Declares if the TermGroup is the Site Collection Term Group, optional attribute.
            </xsd:documentation>
          </xsd:annotation>
        </xsd:attribute>
        <xsd:attribute name="UpdateBehavior" use="optional" default="Skip">
          <xsd:annotation>
            <xsd:appinfo>Added with schema version 201705</xsd:appinfo>
            <xsd:documentation xml:lang="en">
              If the TermGroup already exists on target, this attribute defines whether 
              the TermGroup will be overwritten or skipped.
            </xsd:documentation>
          </xsd:annotation>
          <xsd:simpleType>
            <xsd:restriction base="xsd:string">
              <xsd:enumeration value="Overwrite">
                <xsd:annotation>
                  <xsd:documentation xml:lang="en">
                    Any existing TermGroup will be overwritten
                  </xsd:documentation>
                </xsd:annotation>
              </xsd:enumeration>
              <xsd:enumeration value="Skip">
                <xsd:annotation>
                  <xsd:documentation xml:lang="en">
                    Any existing TermGroup will be skipped
                  </xsd:documentation>
                </xsd:annotation>
              </xsd:enumeration>
            </xsd:restriction>
          </xsd:simpleType>        
        </xsd:attribute>
      </xsd:extension>
    </xsd:complexContent>
  </xsd:complexType>

  <xsd:complexType name="TaxonomyItem">
    <xsd:annotation>
      <xsd:documentation xml:lang="en">
        Base Type for TermGroup, TermSet and Term.
      </xsd:documentation>
    </xsd:annotation>
    <xsd:attribute name="Name" type="xsd:string" use="required">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          The Name of the Taxonomy Item, required attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>
    <xsd:attribute name="ID" type="pnp:GUID" use="optional">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          The ID of the Taxonomy Item, optional attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>
  </xsd:complexType>

  <xsd:complexType name="TermSetItem" >
    <xsd:annotation>
      <xsd:documentation xml:lang="en">
        Base type for TermSets and Terms
      </xsd:documentation>
    </xsd:annotation>
    <xsd:complexContent>
      <xsd:extension base="pnp:TaxonomyItem">
        <xsd:attribute name="Owner" type="xsd:string" use="optional">
          <xsd:annotation>
            <xsd:documentation xml:lang="en">
              The Owner of the Term Set Item, optional attribute.
            </xsd:documentation>
          </xsd:annotation>
        </xsd:attribute>
        <xsd:attribute name="Description" type="xsd:string" use="optional">
          <xsd:annotation>
            <xsd:documentation xml:lang="en">
              The Description of the Term Set Item, optional attribute.
            </xsd:documentation>
          </xsd:annotation>
        </xsd:attribute>
        <xsd:attribute name="IsAvailableForTagging" type="xsd:boolean" use="optional" default="true">
          <xsd:annotation>
            <xsd:documentation xml:lang="en">
              Declares whether the Term Set Item is available for tagging, optional attribute.
            </xsd:documentation>
          </xsd:annotation>
        </xsd:attribute>
      </xsd:extension>
    </xsd:complexContent>
  </xsd:complexType>

  <xsd:complexType name="TermSet">
    <xsd:annotation>
      <xsd:documentation xml:lang="en">
        A TermSet to provision.
      </xsd:documentation>
    </xsd:annotation>
    <xsd:complexContent>
      <xsd:extension base="pnp:TermSetItem">
        <xsd:all>
          <xsd:element name="CustomProperties" type="pnp:TaxonomyItemProperties" minOccurs="0" maxOccurs="1">
            <xsd:annotation>
              <xsd:documentation xml:lang="en">
                The Custom Properties of the Term Set, optional collection of elements.
              </xsd:documentation>
            </xsd:annotation>
          </xsd:element>
          <xsd:element name="Terms" minOccurs="0" maxOccurs="1">
            <xsd:complexType>
              <xsd:sequence>
                <xsd:element name="Term" type="pnp:Term" minOccurs="0" maxOccurs="unbounded">
                  <xsd:annotation>
                    <xsd:documentation xml:lang="en">
                      A child Term of the current Term Set Item, optional collection of elements.
                    </xsd:documentation>
                  </xsd:annotation>
                </xsd:element>
              </xsd:sequence>
            </xsd:complexType>
          </xsd:element>
        </xsd:all>
        <xsd:attribute name="Language" type="xsd:int" use="optional">
          <xsd:annotation>
            <xsd:documentation xml:lang="en">
              The reference Language for the Term Set, optional attribute.
            </xsd:documentation>
          </xsd:annotation>
        </xsd:attribute>
        <xsd:attribute name="IsOpenForTermCreation" type="xsd:boolean" use="optional" default="false">
          <xsd:annotation>
            <xsd:documentation xml:lang="en">
              Declares whether the Term Set is open for terms creation or not, optional attribute.
            </xsd:documentation>
          </xsd:annotation>
        </xsd:attribute>
      </xsd:extension>
    </xsd:complexContent>
  </xsd:complexType>

  <xsd:complexType name="Term">
    <xsd:annotation>
      <xsd:documentation xml:lang="en">
        A Term to provision into a TermSet or a hyerarchical Term.
      </xsd:documentation>
    </xsd:annotation>
    <xsd:complexContent>
      <xsd:extension base="pnp:TermSetItem">
        <xsd:all>
          <xsd:element name="Terms" minOccurs="0" maxOccurs="1">
            <xsd:complexType>
              <xsd:choice>
                <xsd:element name="Term" type="Term"  maxOccurs="unbounded" minOccurs="0">
                  <xsd:annotation>
                    <xsd:documentation xml:lang="en">
                      A child Term of the current Term Set Item, optional collection of elements.
                    </xsd:documentation>
                  </xsd:annotation>
                </xsd:element>
              </xsd:choice>
            </xsd:complexType>
          </xsd:element>
          <xsd:element name="Labels" minOccurs="0" maxOccurs="1" type="pnp:TermLabels">
            <xsd:annotation>
              <xsd:documentation xml:lang="en">
                The Labels of the current Term, optional element.
              </xsd:documentation>
            </xsd:annotation>
          </xsd:element>
          <xsd:element name="CustomProperties" type="pnp:TaxonomyItemProperties" minOccurs="0" maxOccurs="1">
            <xsd:annotation>
              <xsd:documentation xml:lang="en">
                The Custom Properties, optional collection of elements.
              </xsd:documentation>
            </xsd:annotation>
          </xsd:element>
          <xsd:element name="LocalCustomProperties" type="pnp:TaxonomyItemProperties" minOccurs="0" maxOccurs="1">
            <xsd:annotation>
              <xsd:documentation xml:lang="en">
                The Term local Custom Properties, optional collection of elements.
              </xsd:documentation>
            </xsd:annotation>
          </xsd:element>
        </xsd:all>
        <xsd:attribute name="Language" type="xsd:int" use="optional">
          <xsd:annotation>
            <xsd:documentation xml:lang="en">
              The reference Language for the Term, optional attribute.
            </xsd:documentation>
          </xsd:annotation>
        </xsd:attribute>
        <xsd:attribute name="CustomSortOrder" type="xsd:int" use="optional" default="0">
          <xsd:annotation>
            <xsd:documentation xml:lang="en">
              The Custom Sort Order for the Term, optional attribute.
            </xsd:documentation>
          </xsd:annotation>
        </xsd:attribute>
        <xsd:attribute name="IsReused" type="xsd:boolean" use="optional" default="false">
          <xsd:annotation>
            <xsd:documentation xml:lang="en">
              Declares if this term is reused, optional attribute.
            </xsd:documentation>
          </xsd:annotation>
        </xsd:attribute>
        <xsd:attribute name="IsSourceTerm" type="xsd:boolean" use="optional" default="true">
          <xsd:annotation>
            <xsd:documentation xml:lang="en">
              If the IsReused property is set to false, the current Term is not reused and this property will always be true. If the current Term is reused (IsReused returns true), then this property should be set to true if it is the source Term.
            </xsd:documentation>
          </xsd:annotation>
        </xsd:attribute>
        <xsd:attribute name="IsDeprecated" type="xsd:boolean" use="optional" default="false">
          <xsd:annotation>
            <xsd:documentation xml:lang="en">
              Declares if this term is deprecated, optional attribute.
            </xsd:documentation>
          </xsd:annotation>
        </xsd:attribute>
        <xsd:attribute name="SourceTermId" type="pnp:GUID" use="optional">
          <xsd:annotation>
            <xsd:documentation xml:lang="en">
              The ID of the source term if this term is reused, optional attribute.
            </xsd:documentation>
          </xsd:annotation>
        </xsd:attribute>
      </xsd:extension>
    </xsd:complexContent>
  </xsd:complexType>

  <xsd:complexType name="TaxonomyItemProperties">
    <xsd:annotation>
      <xsd:documentation xml:lang="en">
        A collection of Term Properties.
      </xsd:documentation>
    </xsd:annotation>
    <xsd:sequence>
      <xsd:element name="Property" type="pnp:StringDictionaryItem"
                    minOccurs="1" maxOccurs="unbounded">
        <xsd:annotation>
          <xsd:documentation xml:lang="en">
            A Term Property, collection of elements.
          </xsd:documentation>
        </xsd:annotation>
      </xsd:element>
    </xsd:sequence>
  </xsd:complexType>

  <xsd:complexType name="TermLabels">
    <xsd:annotation>
      <xsd:documentation xml:lang="en">
        A collection of Term Labels, in order to support multi-language terms.
      </xsd:documentation>
    </xsd:annotation>
    <xsd:sequence>
      <xsd:element name="Label" minOccurs="1" maxOccurs="unbounded">
        <xsd:complexType>
          <xsd:attribute name="Language" type="xsd:int" use="required">
            <xsd:annotation>
              <xsd:documentation xml:lang="en">
                The reference Language for the Term Label, required attribute.
              </xsd:documentation>
            </xsd:annotation>
          </xsd:attribute>
          <xsd:attribute name="Value" type="xsd:string" use="required">
            <xsd:annotation>
              <xsd:documentation xml:lang="en">
                The Value for the Term Label, required attribute.
              </xsd:documentation>
            </xsd:annotation>
          </xsd:attribute>
          <xsd:attribute name="IsDefaultForLanguage" type="xsd:boolean" use="optional" default="false">
            <xsd:annotation>
              <xsd:documentation xml:lang="en">
                Declares whether the current Label is the default for the specific Language, optional attribute.
              </xsd:documentation>
            </xsd:annotation>
          </xsd:attribute>
        </xsd:complexType>
      </xsd:element>
    </xsd:sequence>
  </xsd:complexType>

  <xsd:complexType name="TermSets">
    <xsd:annotation>
      <xsd:documentation xml:lang="en">
        A collection of TermSets to provision.
      </xsd:documentation>
    </xsd:annotation>
    <xsd:sequence>
      <xsd:element name="TermSet" type="pnp:TermSet" maxOccurs="unbounded" minOccurs="0">
        <xsd:annotation>
          <xsd:documentation xml:lang="en">
            A Term Set, optional collection of elements.
          </xsd:documentation>
        </xsd:annotation>
      </xsd:element>
    </xsd:sequence>
  </xsd:complexType>

  <xsd:complexType name="Extensions">
    <xsd:annotation>
      <xsd:documentation xml:lang="en">
        Extensions are custom XML elements and instructions that can be extensions of this default schema or vendor or engine specific extensions.
      </xsd:documentation>
    </xsd:annotation>
    <xsd:sequence minOccurs="0" maxOccurs="unbounded">
      <xsd:any processContents="lax" namespace="##other"/>
    </xsd:sequence>
  </xsd:complexType>

  <xsd:complexType name="ImportSequence">
    <xsd:annotation>
      <xsd:documentation xml:lang="en">
        Imports sequences from an external file. All current properties should be sent to that file.
      </xsd:documentation>
    </xsd:annotation>
    <xsd:attribute name="File" type="xsd:string" use="required">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          Absolute or relative path to the file, required attribute.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>
  </xsd:complexType>

  <xsd:simpleType name="GUID">
    <xsd:annotation>
      <xsd:documentation xml:lang="en">
        The description of a Global Unique IDentifier
      </xsd:documentation>
    </xsd:annotation>
    <xsd:restriction base="xsd:string">
      <xsd:pattern value="(\{)?[a-fA-F0-9]{8}(-[a-fA-F0-9]{4}){3}-[a-fA-F0-9]{12}(\})?"/>
    </xsd:restriction>
  </xsd:simpleType>

  <xsd:simpleType name='ReplaceableString' id='ReplaceableString'>
    <xsd:annotation>
      <xsd:documentation>
        A Replaceable string is a string that contains parameters enclosed by curly braces {...}
        At runtime the provisioning engine replaces those parameters with the parameters specified in Preferences/Parameters
      </xsd:documentation>
    </xsd:annotation>
    <xsd:restriction base='xsd:string'>
      <xsd:annotation>
        <xsd:documentation>
          TODO: this should be replaced with a better regexp to validate Replaceable strings
          Can be something like "{argument}" or "~argument"
        </xsd:documentation>
      </xsd:annotation>
      <xsd:pattern value='[\s\S]*'/>
    </xsd:restriction>
  </xsd:simpleType>

  <xsd:simpleType name='ReplaceableInt' id='ReplaceableInt'>
    <xsd:annotation>
      <xsd:documentation>
        A Replaceable Int is an integer  that contains parameters enclosed by curly braces {...}
        At runtime the provisioning engine replaces those parameters with the parameters specified in Preferences/Parameters
      </xsd:documentation>
    </xsd:annotation>
    <xsd:restriction base='xsd:string'>
      <xsd:annotation>
        <xsd:documentation>
          TODO: regexp that validates either an integer or something like this "{lcid}" or something like "~lcid"
        </xsd:documentation>
      </xsd:annotation>
      <xsd:pattern value='[\s\S]+'/>
    </xsd:restriction>
  </xsd:simpleType>

  <xsd:simpleType name='ContentTypeId' id='ContentTypeId'>
    <xsd:restriction base='xsd:string'>
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          A Content Type ID
        </xsd:documentation>
      </xsd:annotation>
      <xsd:pattern value='0x[a-zA-Z0-9]+'/>
    </xsd:restriction>
  </xsd:simpleType>

  <xsd:simpleType name="WikiPageLayout">
    <xsd:annotation>
      <xsd:documentation xml:lang="en">
        The column layout of a wiki page
      </xsd:documentation>
    </xsd:annotation>
    <xsd:restriction base="xsd:string">
      <xsd:enumeration value="OneColumn" />
      <xsd:enumeration value="OneColumnSidebar" />
      <xsd:enumeration value="TwoColumns" />
      <xsd:enumeration value="TwoColumnsHeader" />
      <xsd:enumeration value="TwoColumnsHeaderFooter" />
      <xsd:enumeration value="ThreeColumns" />
      <xsd:enumeration value="ThreeColumnsHeader" />
      <xsd:enumeration value="ThreeColumnsHeaderFooter" />
      <xsd:enumeration value="Custom" />
    </xsd:restriction>
  </xsd:simpleType>

  <xsd:simpleType name="RegistrationType">
    <xsd:annotation>
      <xsd:documentation xml:lang="en">
        The Registration Type for Custom Action
      </xsd:documentation>
    </xsd:annotation>
    <xsd:restriction base="xsd:string">
      <xsd:enumeration value="None" />
      <xsd:enumeration value="List" />
      <xsd:enumeration value="ContentType" />
      <xsd:enumeration value="ProgId" />
      <xsd:enumeration value="FileType" />
    </xsd:restriction>
  </xsd:simpleType>

  <xsd:simpleType name="FileLevel">
    <xsd:annotation>
      <xsd:documentation xml:lang="en">
        The File Level for a File element
      </xsd:documentation>
    </xsd:annotation>
    <xsd:restriction base="xsd:string">
      <xsd:enumeration value="Published" />
      <xsd:enumeration value="Draft" />
      <xsd:enumeration value="Checkout" />
    </xsd:restriction>
  </xsd:simpleType>

</xsd:schema>
