---
page_type: sample
products:
- office-outlook
- office-365
- office-sp
- ms-graph
languages:
- javascript
- nodejs
extensions:
  contentType: samples
  technologies:
  - Microsoft Graph
  - Azure AD
  services:
  - Outlook
  - Office 365
  - SharePoint
  createdDate: 1/1/2016 12:00:00 AM
  scenarios:
  - Mobile
---
# Microsoft Graph — экспресс-контакты

### Сводка

В этом примере показано, как быстро находить контакты на мобильных устройствах с помощью Microsoft Graph.

![Снимок экрана](assets/search-results.png)

### Область применения

- Мультитенантная среда (MT) Office 365

### Предварительные требования

- Клиент Office 365
- Настройка приложения в Azure Active Directory (AAD)
    - Разрешения
        - SharePoint Online в Office 365
            - Выполнение поисковых запросов от имени пользователя
        - Microsoft Graph
            - Чтение списка людей, релевантных для пользователя (предварительная версия)
            - Доступ к каталогу, аналогичный доступу вошедшего пользователя
            - Чтение базовых профилей всех пользователей
        - Windows Azure Active Directory
            - Вход и чтение профиля пользователя
    - Включенный неявный поток OAuth
    
### Решение

Решение|Авторы
--------|---------
MicrosoftGraph.Office.QuickContacts|Валдек Мастыкаж (MVP, Rencore, @waldekm), Штефан Бауэр (n8d, @StfBauer)

### Журнал версий

Версия|Дата|Примечания
-------|----|--------
1.0 |24 марта 2016 г.|Первый выпуск

### Заявление об отказе
**ЭТОТ КОД ПРЕДОСТАВЛЯЕТСЯ *КАК ЕСТЬ* БЕЗ КАКОЙ-ЛИБО ЯВНОЙ ИЛИ ПОДРАЗУМЕВАЕМОЙ ГАРАНТИИ, ВКЛЮЧАЯ ПОДРАЗУМЕВАЕМЫЕ ГАРАНТИИ ПРИГОДНОСТИ ДЛЯ КАКОЙ-ЛИБО ЦЕЛИ, ДЛЯ ПРОДАЖИ ИЛИ ГАРАНТИИ ОТСУТСТВИЯ НАРУШЕНИЯ ПРАВ ИНЫХ ПРАВООБЛАДАТЕЛЕЙ.**

---

## Экспресс-контакты Office

В этом примере приложения демонстрируется способ использования Microsoft Graph для быстрого поиска релевантных контактов на мобильном телефоне.

![Найденные контакты, показанные в приложении "Экспресс-контакты Office"](assets/search-results.png)

С помощью нового API людей приложение позволяет находить контакты, включая соответствующие контактные данные.

![Отображение быстрых действий для контакта](assets/quick-actions.png)

Так как в новом API людей используется фонетический поиск, не имеет значения, если вы ввели имя искомого пользователя с ошибкой.

![Результаты поиска при неправильном вводе имени контакта](assets/typo.png)

Коснувшись контакта вы можете получить доступ к дополнительным сведениям. А если это контакт из вашей организации, вы даже получите прямую ссылку на его электронную почту.

![Карточка контакта, открытая в приложении](assets/person-card.png)

## Предварительные требования

Перед запуском этого приложения требуется выполнить несколько действий по настройке.

### Настройка приложения Azure AD

В этом приложении для поиска релевантного контакта используется Microsoft Graph. Чтобы получить доступ к Microsoft Graph, в службе Azure Active Directory должно быть настроено соответствующее приложение Azure Active Directory. Ниже указаны действия по созданию и правильной настройке приложения в AAD: 

- в Azure Active Directory создайте веб-приложение;
- присвойте параметру **URL-адрес входа** значение `https://localhost:8443`;
- скопируйте **Идентификатор клиента**, который потребуется позднее для настройки приложения;
- в поле **URL-адрес ответа** добавьте `https://localhost:8443`. Если вы хотите протестировать приложение на мобильном устройстве, также потребуется добавить **Внешний** URL-адрес, отображаемый в Browserify после запуска приложения с помощью команды `$ gulp serve`;
- предоставьте приложению следующие разрешения:
    - SharePoint Online в Office 365
        - Выполнение поисковых запросов от имени пользователя
    - Microsoft Graph
        - Чтение списка людей, релевантных для пользователя (предварительная версия)
        - Доступ к каталогу, аналогичный доступу вошедшего пользователя
        - Чтение базовых профилей всех пользователей
    - Windows Azure Active Directory
        - Вход и чтение профиля пользователя
- включите неявный поток OAuth.

### Настройка приложения

Перед запуском приложения необходимо связать его с созданным приложением Azure Active Directory и клиентом SharePoint. Оба параметра можно настроить в файле `app/app.config.js`.

- клонируйте этот репозиторий;
- в качестве значения константы **appId** установите ранее скопированный **идентификатор клиента** созданного приложения AAD;
- в качестве значения константы **sharePointUrl** установите URL-адрес своего клиента SharePoint без завершающей косой черты, например `https://contoso.sharepoint.com`.

## Запуск приложения

Для запуска приложения выполните следующие действия:

- в командной строке выполните команду
```
$ npm i && bower i
```
- для запуска приложения выполните в командной строке команду
```
$ gulp serve
```
в командной строке команду

![Приложение, запущенное в браузере](assets/app.png) 

<img src="https://telemetry.sharepointpnp.com/pnp/samples/MicrosoftGraph.Office.QuickContacts" />