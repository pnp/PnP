var SharePointClient=SharePointClient||{};(function(){"use strict";SharePointClient.AddNameSpace=function(n){var t=n.split("."),i=SharePointClient,r=0,u;for(t[0]==="SharePointClient"&&(t=t.slice(1)),r=0;r<t.length;r++)u=t[r],i[u]||(i[u]={}),i=i[u];return i};SharePointClient.AddNameSpace("Configurations");SharePointClient.Configurations={IsApp:!1,SPHostUrl:"",SPAppWebUrl:"",IsCrossDomainRequest:!1,SPUrl:null,REST:{AccessToken:null}};SharePointClient.AddNameSpace("Constants");SharePointClient.Constants={CAML_CONSTANT:{CAML_QUERY_SCOPE:{FILES_ONLY:"FilesOnly",RECURSIVE:"Recursive",RECURSIVE_ALL:"RecursiveAll"},CAML_QUERY_THROTTLE_MODE:{DEFAULT:"Default",OVERRIDE:"Override",STRICT:"Strict"}},REST:{API:"_api",WEB:"web",LISTS:"Lists",REQUEST_DIGEST_ENDPOINT:"contextinfo",HTTP:{GET:"GET",POST:"POST",DATA_TYPE:{JSON:"application/json;odata=verbose",XML:"application/atom+xml;odata=verbose"}}}};SharePointClient.AddNameSpace("Logger");SharePointClient.Logger={LogJSOMException:function(n){console&&console.log("Request failed. "+n.get_message()+"\n"+n.get_stackTrace())},LogRESTException:function(n){console&&console.log("Request failed. "+n)}};SharePointClient.AddNameSpace("Utilities");SharePointClient.Utilities.Utility=function(){var n=SharePointClient.Configurations,t=function(n){for(var r=document.URL.split("?")[1].split("&"),t=0,i,t=0;t<r.length;t=t+1)if(i=r[t].split("="),i[0]===n)return decodeURIComponent(i[1])},f=function(){var n;return _spPageContextInfo&&(n=_spPageContextInfo.webAbsoluteUrl),n},i=function(){return t("SPHostUrl")},e=function(){return t("SPAppWebUrl")},o=function(){var t;return n.IsApp?t=i()+"/_layouts/15/":_spPageContextInfo&&(t=_spPageContextInfo.webAbsoluteUrl+"/_layouts/15/"),t},r=function(){var i;return n.IsApp?i=n.SPUrl?n.SPUrl:t("SPAppWebUrl"):_spPageContextInfo&&(i=_spPageContextInfo.webAbsoluteUrl),i+"/"+SharePointClient.Constants.REST.API+"/"},s=function(){return r()+SharePointClient.Constants.REST.REQUEST_DIGEST_ENDPOINT},h=function(n){var u=n.indexOf("_api/")+5,t=n.substring(0,u),r;return t+="SP.AppContextSite(@target)/",t+=n.substring(u,n.length),r=i(),n.indexOf("?")>0?t+"&@target='"+r+"'":t+"?@target='"+r+"'"},c=function(n){switch(n){case"sp.js":return SP.ClientContext?!0:!1;case"sp.runtime.js":return SP.ClientRuntimeContext?!0:!1;case"sp.requestexecutor.js":return SP.RequestInfo?!0:!1;default:return!1}},l=function(n){var t,i,r;for(n=n.toLowerCase(),t=!1,i=document.getElementsByTagName("script"),r=i.length;r--;)n===a(i[r].src)&&(t=!0);return t||(t=c(n)),t},a=function(n){var t=n.split("?"),i;return n=t.length>0?t[0]:n,i=n.lastIndexOf("/"),n=n.substring(i+1,n.length),n.toLowerCase()},u=function(n,t,i,r){$.getScript(n+t[i],function(){i+1<=t.length-1?u(n,t,i+1,r):r&&r()})};return{GetQueryStringParameter:t,GetHostUrl:i,GetAppWebUrl:e,IsScriptExistsOnPage:l,GetUrlFromPageContextInfo:f,GetScript:u,JSOM:{GetBaseUrl:o},REST:{GetApiUrl:r,GetRequestDigestUrl:s,GetCrossDomainRequestUrl:h}}};SharePointClient.AddNameSpace("Utilities.CamlQueryUtility");SharePointClient.Utilities.CamlQueryUtility={ConvertToCamlSchema:function(n,t){var f,i;if(typeof t=="string"||typeof t=="number")return"<"+n+">"+t+"<\/"+n+">";var r="<"+n,e={},o={},u;return $.each(t,function(n,t){SharePointClient.Utilities.CamlQueryUtility.IsAttribute(n)?e[n]=t:n.indexOf("_")===0?u=t:o[n]=t}),f=SharePointClient.Utilities.CamlQueryUtility.Attributes(e),r+=f.length>0?f+">":">",i="",$.each(o,function(n,t){i+=typeof t=="object"?SharePointClient.Utilities.CamlQueryUtility.ConvertToCamlSchema(n,t):"<"+n+">"+t+"<\/"+n+">"}),i.length>0&&(r+=i),u&&(r+=u),r+("<\/"+n+">")},IsAttribute:function(n){return typeof n=="object"?!1:n.indexOf("@")===0?!0:!1},Attributes:function(n){if(typeof n=="string"||typeof jsonObject=="number")return n.indexOf("@")===0?n:"";var t="";return $.each(n,function(n,i){n.indexOf("@")===0&&(t+=" "+n.replace("@","")+"='"+i+"'")}),t}};SharePointClient.AddNameSpace("CamlExtension");SharePointClient.CamlExtension={JSOM:{CamlQuery:function(){$.extend(this,new SP.CamlQuery)}},REST:{CamlQuery:function(){var n={},t=null,i=function(){return t},v=function(){return t="<View Scope='RecursiveAll'><Query><\/Query><\/View>",this},y=function(){return t="<View Scope='RecursiveAll'><Query><Where><Eq><FieldRef Name='FSObjType' /><Value Type='Integer'>1<\/Value><\/Eq><\/Where><\/Query><\/View>",this},r=function(t){return n.View={"@Scope":t},this},u=function(t){return n.Query=t,this},f=function(t){for(var i="",r=0,r=0;r<=t.length-1;r++)i+="<FieldRef ",i+="Name='"+t[r]+"'",i+="><\/FieldRef>";return n.ViewFields=i,this},e=function(t){return n.ViewFields=t,this},o=function(t){return n.QueryOptions={QueryThrottleMode:t},this},s=function(){return n.OrderBy={"@UseIndexForOrderBy":"TRUE","@Override":"TRUE"},this},h=function(){return n.OrderBy={"@UseIndexForOrderBy":"TRUE",FieldRef:{"@Name":"ID"}},this},c=function(){return n.OrderBy={"@UseIndexForOrderBy":"TRUE",FieldRef:{"@Name":"ID","@Ascending":"FALSE"}},this},l=function(t){return n.RowLimit={"@Paged":"TRUE",_value:t},this},a=function(){var r=SharePointClient.Utilities.CamlQueryUtility,u="",i="",a="",v="",f="",y="",e,w=n.View,o,s,h,c,l;if(e=r.Attributes(w),u+=e.length>0?"<View"+e+">":"<View>",o=n.Query,o&&(i=r.ConvertToCamlSchema("Query",o)),s=n.ViewFields,s&&(a=r.ConvertToCamlSchema("ViewFields",s)),h=n.QueryOptions,h&&(v=r.ConvertToCamlSchema("QueryOptions",h)),c=n.OrderBy,c)if(f=r.ConvertToCamlSchema("OrderBy",c),i.length===0)i+="<Query>",i+=f,i+="<\/Query>";else{var p=i.indexOf("<\/Query>"),b=i.substring(0,p),k=i.substring(p,i.length);i=b+f+k}return l=n.RowLimit,l&&(y=r.ConvertToCamlSchema("RowLimit",l)),u+=i+a+v+y+"<\/View>",t=u,this};return{SetViewScopeAttribute:r,SetQuery:u,SetViewFields:f,SetViewFieldsXml:e,OverrideQueryThrottleMode:o,OverrideOrderByIndex:s,OverrideOrderBy:h,OverrideOrderByDesc:c,SetRowLimit:l,BuildQuery:a,GetQueryViewXml:i}}}};SharePointClient.CamlExtension.JSOM.CamlQuery.prototype={queryStatement:{},CreateAllItemsQuery:function(){return SP.CamlQuery.createAllItemsQuery()},CreateAllFoldersQuery:function(){return SP.CamlQuery.createAllFoldersQuery()},ViewAttribute:function(n){return this.queryStatement.View={"@Scope":n},this},Query:function(n){return this.queryStatement.Query=n,this},ViewFields:function(n){for(var t="",i=0,i=0;i<=n.length-1;i++)t+="<FieldRef ",t+="Name='"+n[i]+"'",t+="><\/FieldRef>";return this.queryStatement.ViewFields=t,this},ViewFieldsXml:function(n){return this.queryStatement.ViewFields=n,this},QueryThrottleMode:function(n){return this.queryStatement.QueryOptions={QueryThrottleMode:n},this},OrderByIndex:function(){return this.queryStatement.OrderBy={"@UseIndexForOrderBy":"TRUE","@Override":"TRUE"},this},OrderBy:function(){return this.queryStatement.OrderBy={"@UseIndexForOrderBy":"TRUE",FieldRef:{"@Name":"ID"}},this},OrderByDesc:function(){return this.queryStatement.OrderBy={"@UseIndexForOrderBy":"TRUE",FieldRef:{"@Name":"ID","@Ascending":"FALSE"}},this},RowLimit:function(n){return this.queryStatement.RowLimit=n,this},BuildQuery:function(){var t=SharePointClient.Utilities.CamlQueryUtility,i="",n="",c="",l="",r="",a="",u,y=this.queryStatement.View,f,e,o,s,h;if(u=t.Attributes(y),i+=u.length>0?"<View"+u+">":"<View>",f=this.queryStatement.Query,f&&(n=t.ConvertToCamlSchema("Query",f)),e=this.queryStatement.ViewFields,e&&(c=t.ConvertToCamlSchema("ViewFields",e)),o=this.queryStatement.QueryOptions,o&&(l=t.ConvertToCamlSchema("QueryOptions",o)),s=this.queryStatement.OrderBy,s)if(r=t.ConvertToCamlSchema("OrderBy",s),n.length===0)n+="<Query>",n+=r,n+="<\/Query>";else{var v=n.indexOf("<\/Query>"),p=n.substring(0,v),w=n.substring(v,n.length);n=p+r+w}return h=this.queryStatement.RowLimit,h&&(a=t.ConvertToCamlSchema("RowLimit",h)),i+=n+c+l+a+"<\/View>",this.set_viewXml(i),this}};SharePointClient.AddNameSpace("Services");SharePointClient.Services={ClientRun:function(){var n=function(){},t=function(){},i=function(i,r){i&&(n=i);r&&(t=r)};return{Execute:i,OnSuccess:function(t){return n(t)},OnError:function(){return t}}},JSOM:{Initialize:function(n){var i=new SharePointClient.Utilities.Utility,f=SharePointClient.Configurations,e=i.JSOM.GetBaseUrl(),r=["SP.Runtime.js","SP.js"],u,t;if(f.IsCrossDomainRequest&&(u=jQuery.grep(r,function(n){return n!==""&&n!==null&&n==="SP.RequestExecutor.js"}),u.length===0&&r.push("SP.RequestExecutor.js")),t=[],$.each(r,function(n,r){i.IsScriptExistsOnPage(r)||t.push(r)}),t.length===0){n();return}$.ajaxSetup({cache:!0});i.GetScript(e,t,0,function(){n()});$.ajaxSetup({cache:!1})},Context:function(){var t=new SharePointClient.Utilities.Utility,n=null,i=null,f=function(){SP.ClientContext&&(n=SP.ClientContext.get_current(),i=n.get_web())},r=function(t){SP.ClientContext&&(n=new SP.ClientContext(t),i=n.get_web())},e=function(){var u,f;r(t.GetAppWebUrl());u=new SP.ProxyWebRequestExecutorFactory(t.GetAppWebUrl());n.set_webRequestExecutorFactory(u);f=new SP.AppContextSite(n,t.GetHostUrl());i=f.get_web()},u=function(){var n=SharePointClient.Configurations;n.IsApp?(n.SPHostUrl=t.GetHostUrl(),n.SPAppWebUrl=t.GetAppWebUrl(),n.IsCrossDomainRequest?e():n.SPUrl?r(n.SPUrl):r(t.GetAppWebUrl())):f()};return{GetClientContext:function(){return n||u(),n},GetWeb:function(){return n||u(),i}}},ListServices:function(){var i=function(n){var i=n.GetClientContext(),u=n.GetWeb(),r=u.get_lists();return i.load(r,"Include(Title, Id)"),t(i,r)},r=function(n,i){var r=n.GetClientContext(),f=n.GetWeb(),e=f.get_lists(),u=e.getByTitle(i);return r.load(u),t(r,u)},u=function(t,i,r){var e=new SharePointClient.Services.ClientRun,o=new SP.ListItemCollectionPosition,u,f;return o.set_pagingInfo(""),r.set_listItemCollectionPosition(o),u=null,f=new SharePointClient.Services.ClientRun,n(t,r,i,f),f.Execute(function(n){if(u?$.each(n,function(n,t){$.isArray(t)&&$.each(u,function(n,i){$.isArray(i)&&$.each(t,function(n,t){i.push(t)})})}):u=n,!n.get_listItemCollectionPosition()){u||(u=new SP.ListItemCollection(t.GetClientContext()));var i=u.get_listItemCollectionPosition();i.set_pagingInfo(n.get_listItemCollectionPosition());e.OnSuccess(u)}}),e},f=function(t,i,r){var u=new SharePointClient.Services.ClientRun,f=new SP.ListItemCollectionPosition;return f.set_pagingInfo(""),r.set_listItemCollectionPosition(f),n(t,r,i,u),u},n=function(t,i,r,u){var e=t.GetClientContext(),o=t.GetWeb(),s=o.get_lists().getByTitle(r),f=s.getItems(i);e.load(f);e.executeQueryAsync(function(){if(u.OnSuccess(f),f.get_listItemCollectionPosition())i.set_listItemCollectionPosition(f.get_listItemCollectionPosition()),n(t,i,r,u);else return},function(n,t){SharePointClient.Logger.LogJSOMException(t)})},t=function(n,t){var i=new SharePointClient.Services.ClientRun;return n.executeQueryAsync(function(){i.OnSuccess(t)},function(n,t){SharePointClient.Logger.LogJSOMException(t);i.OnError(t)}),i};return{GetLists:i,GetListByTitle:r,GetListItemsByListName:u,GetListItemsBatchByListName:f}}},REST:{RESTService:function(){$.support.cors=!0;var r={call:function(r,u,f,o,s){var h=$.ajax({url:r,type:u,contentType:o,data:n(f,s),headers:e(o)});return h.then(t,i)}},u={call:function(r,u,f,e,s,h){var c=$.ajax({url:r,type:u,data:n(f,h),headers:o(s,e)});return c.then(t,i)}},f={call:function(n,t,i,r){var u=jQuery.Deferred(),f=new SharePointClient.Utilities.Utility,e=new SP.RequestExecutor(f.GetQueryStringParameter("SPAppWebUrl")),o=f.REST.GetCrossDomainRequestUrl(n),s=e.executeAsync({url:o,method:t,headers:{Accept:r,"Content-Type":SharePointClient.Constants.REST.HTTP.DATA_TYPE.JSON},body:JSON.stringify(i),success:function(n){u.resolve(n.body)},error:function(n,t,i){u.reject(i)}});return u.promise()}},n=function(n,t){return t?JSON.stringify(n):n},e=function(n){var t={Accept:n};return SharePointClient.Configurations.AccessToken&&(t.Authorization="Bearer "+SharePointClient.Configurations.AccessToken),t},o=function(n,t){var i={Accept:n,"X-RequestDigest":t,"Content-Type":SharePointClient.Constants.REST.HTTP.DATA_TYPE.JSON};return SharePointClient.Configurations.AccessToken&&(i.Authorization="Bearer "+SharePointClient.Configurations.AccessToken),i},t=function(n){return n},i=function(n){SharePointClient.Logger.LogRESTException("Exception : "+n.responseText)};return{Request:r.call,RequestWithDigest:u.call,RequestCrossDomain:f.call}},ListServices:function(){var t=new SharePointClient.Utilities.Utility,n=SharePointClient.Constants.REST,i=SharePointClient.Services.REST.RESTService(),f=function(r){var u=new SharePointClient.Services.ClientRun,f=t.REST.GetApiUrl()+n.WEB+"/"+n.LISTS;return i.Request(f,n.HTTP.GET,null,r,!1).then(function(n){u.OnSuccess(n)}),u},e=function(r,u){var f=new SharePointClient.Services.ClientRun,e=t.REST.GetApiUrl()+n.WEB+"/"+n.LISTS+"/getbytitle('"+r+"')";return i.Request(e,n.HTTP.GET,null,u,!1).then(function(n){f.OnSuccess(n)}),f},r=function(n,t,u,f,e){return i.RequestCrossDomain(n,t,u,f,!0).then(function(t){var i,o,s;return i=f===SharePointClient.Constants.REST.HTTP.DATA_TYPE.JSON?$.parseJSON($.parseJSON(t).d.RenderListData):$.parseJSON($($.parseXML(t).lastChild).text()),e.OnSuccess(t),i.NextHref&&(o=n,s=n.split("?"),o=s.length===2?s[0]+i.NextHref:n+i.NextHref,r(o,SharePointClient.Constants.REST.HTTP.POST,u,f,e)),i},function(n){SharePointClient.Logger.LogRESTException("Exception : "+n.responseText)})},u=function(n,t,r,f,e,o){return i.RequestWithDigest(n,t,r,f,e,!0).then(function(t){var i,s=n,h=n.split("?");return i=e===SharePointClient.Constants.REST.HTTP.DATA_TYPE.JSON?JSON.parse(t.d.RenderListData):$.parseJSON($(t.lastChild).text()),o.OnSuccess(t),i.NextHref&&(s=h.length===2?h[0]+i.NextHref:n+i.NextHref,u(s,SharePointClient.Constants.REST.HTTP.POST,r,f,e,o)),i},function(n){SharePointClient.Logger.LogRESTException("Exception : "+n.responseText)})},o=function(n,t){return SharePointClient.Configurations.IsCrossDomainRequest?t===SharePointClient.Constants.REST.HTTP.DATA_TYPE.JSON?$.parseJSON($.parseJSON(n).d.RenderListData):$.parseJSON($($.parseXML(n).lastChild).text()):t===SharePointClient.Constants.REST.HTTP.DATA_TYPE.JSON?JSON.parse(n.d.RenderListData):$.parseJSON($(n.lastChild).text())},s=function(n){return'<d:RenderListData xmlns:d="http://schemas.microsoft.com/ado/2007/08/dataservices" xmlns:m="http://schemas.microsoft.com/ado/2007/08/dataservices/metadata" xmlns:georss="http://www.georss.org/georss" xmlns:gml="http://www.opengis.net/gml">'+JSON.stringify(n)+"<\/d:RenderListData>"},h=function(f,e,h){var a=new SharePointClient.Services.ClientRun,l=new SharePointClient.Services.ClientRun,v=t.REST.GetApiUrl()+n.WEB+"/"+n.LISTS+"/getbytitle('"+f+"')/RenderListData",y={viewXml:e.GetQueryViewXml()},c;return SharePointClient.Configurations.IsCrossDomainRequest?$.getScript(t.GetQueryStringParameter("SPHostUrl")+"/_layouts/15/SP.RequestExecutor.js",function(){return r(v,n.HTTP.POST,y,h,l)}):i.Request(t.REST.GetRequestDigestUrl(),n.HTTP.POST,null,n.HTTP.DATA_TYPE.JSON,!1).then(function(t){var i=t.d.GetContextWebInformation.FormDigestValue;u(v,n.HTTP.POST,y,i,h,l)}),c=null,l.Execute(function(n){var t=o(n,h),i;c?$.each(t,function(n,t){$.isArray(t)&&$.each(c,function(n,i){$.isArray(i)&&$.each(t,function(n,t){i.push(t)})})}):c=t;t.NextHref||(c.NextHref=t.NextHref,i=c,h===SharePointClient.Constants.REST.HTTP.DATA_TYPE.XML&&(i=$.parseXML(s(i))),a.OnSuccess(i))}),a},c=function(f,e,o){var s=new SharePointClient.Services.ClientRun,h=t.REST.GetApiUrl()+n.WEB+"/"+n.LISTS+"/getbytitle('"+f+"')/RenderListData",c={viewXml:e.GetQueryViewXml()};return SharePointClient.Configurations.IsCrossDomainRequest?$.getScript(t.GetQueryStringParameter("SPHostUrl")+"/_layouts/15/SP.RequestExecutor.js",function(){return r(h,n.HTTP.POST,c,o,s)}):i.Request(t.REST.GetRequestDigestUrl(),n.HTTP.POST,null,n.HTTP.DATA_TYPE.JSON,!1).then(function(t){var i=t.d.GetContextWebInformation.FormDigestValue;u(h,n.HTTP.POST,c,i,o,s)}),s};return{GetLists:f,GetListByTitle:e,GetListItemsByListName:h,GetListItemsBatchByListName:c}}}}})();
//# sourceMappingURL=SharePointClient.min.js.map
